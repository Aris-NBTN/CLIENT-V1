import{r as o,d as m,f as H,c as A,b1 as L,b2 as R,j as d,V as u,a1 as q,b3 as w,e as I}from"./index-lNmQ6pPM.js";import{b7 as O}from"./Layout-DqfM9Czv.js";import{P as W,p as G,b as J,a as N,c as U,d as V,B as s}from"./index-BVKRu4_V.js";import{S as P}from"./index-BcZ8U7N5.js";import"./animate-BdXqkjvK.js";import"./context-CUE1QV7u.js";import"./index-CX6kIjy3.js";import"./index-e9E4Eznx.js";import"./index-DhylY7XP.js";import"./EllipsisOutlined-CluEmbrc.js";import"./Overflow-DhLxrU27.js";import"./collapse-BbEVqHco.js";import"./button-Dbd4bCs5.js";import"./index-Dlpz5ZWz.js";import"./compact-item-jx5--PBY.js";import"./index-C_LiCepb.js";import"./useLocale-EOjqn1BF.js";import"./TextArea-BScckojm.js";import"./CheckOutlined-Bu_4z2Np.js";import"./index-BgTywfAu.js";import"./PurePanel-Ds767hvM.js";import"./index-BzcOZ8aO.js";import"./SearchOutlined-Dl7tVZ19.js";import"./index-BSeTdN3q.js";import"./responsiveObserver-RbYF2S9F.js";import"./GrapeJs-SEfVZpqD.js";import"./fileApi-W6XlCXt-.js";import"./row-BpNfuUoC.js";const yt=()=>{var S,b;const[k,B]=o.useState(""),[g,C]=o.useState(!1),h=m(t=>t.pluginsScript.pluginsScript),j=m(t=>t.pluginsScript.loading),{plugins:f,loading:_}=m(t=>t.plugins),T=o.useMemo(()=>f.map(t=>({id:t.id,src:`${H}/uploads/${t.src}`})),[f]),M=A(),$=(t,n)=>{const a=new Date,{html:i,css:p,js:e}=n,E=new DOMParser().parseFromString(i,"text/html"),r=E.querySelector("#Header"),l=E.querySelector("#Footer");let v="",x="";const y=i.match(/<body[^>]*>([\s\S]*?)<\/body>/i);if(y&&y[1].trim()===""&&console.log("không có dữ liệu"),!r){u("Chưa có Header!");return}if(!l){u("Chưa có Footer!");return}r&&(v=`<div class="${r.className}">${r.innerHTML}</div>`),l&&(x=`<div id="Footer">${l.innerHTML}</div>`),q(a,"Đang cập nhật..."),L.putLayout(w,{header:v,footer:x,css:p,js:e,edit:t}).then(()=>{I(a,"Cập nhật thành công")}).catch(F=>{u(F.response.data.message)})},D=t=>{t.loadProjectData(k.edit);const n=["video","map","video","bootstrapIcon","map","model-3D","Masonry","quote","link-block","text-basic","text-section","column1","column2","column3","column3-7"],a=["gjs-open-import-webpage","open-templates","link-page","export-template"],i=["Extra","Blog","Layout","Short Codes"],{models:p}=t.BlockManager.getCategories();n.forEach(e=>t.BlockManager.remove(e)),a.forEach(e=>{t.Panels.removeButton("options",e)}),p.forEach(e=>{var c;return i.includes((c=e.get)==null?void 0:c.call(e,"id"))&&e.set("open",!1)})};return o.useEffect(()=>{L.getLayoutEdit().then(t=>{B(t[0]),C(!0)})},[]),o.useEffect(()=>{j===!0&&M(R())},[]),d.jsxs(O,{margin:0,header:"BỐ CỤC WEBSITE",children:[!g&&d.jsx("div",{children:"LOAdding"}),g&&d.jsx(W,{height:"calc(100vh - 56px)",configGrapeJs:D,scripts:(S=h[0])==null?void 0:S.scripts,styles:(b=h[0])==null?void 0:b.styles,pluginss:T,plugins:[G,J,N,U,V,s.imageLink,s.header,s.footer,s.container,s.user,P.customType,P.customTypeSelect],savePage:$})]})};export{yt as default};

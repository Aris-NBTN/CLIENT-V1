import{r as o,ah as X,aZ as Z}from"./index-DlYMrpPW.js";var I={exports:{}},w={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var F;function $(){if(F)return w;F=1;var t=X,e=Symbol.for("react.element"),c=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,r=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,n={key:!0,ref:!0,__self:!0,__source:!0};function u(a,i,d){var m,g={},p=null,l=null;d!==void 0&&(p=""+d),i.key!==void 0&&(p=""+i.key),i.ref!==void 0&&(l=i.ref);for(m in i)s.call(i,m)&&!n.hasOwnProperty(m)&&(g[m]=i[m]);if(a&&a.defaultProps)for(m in i=a.defaultProps,i)g[m]===void 0&&(g[m]=i[m]);return{$$typeof:e,type:a,key:p,ref:l,props:g,_owner:r.current}}return w.Fragment=c,w.jsx=u,w.jsxs=u,w}I.exports=$();var f=I.exports;const U=o.createContext(null),z=({children:t})=>{const[e,c]=o.useState({setEditor:s=>{c(r=>({...r,editor:s}))}});return f.jsx(U.Provider,{value:e,children:t})},h=()=>{const t=o.useContext(U);if(!t)throw new Error("useEditorInstance must be used within EditorInstanceProvider");return t},ae=()=>{const{editor:t}=h();if(!t)throw new Error("useEditor used before the load of the editor instance. You can wrap your component in `<WithEditor>` or make use of `useEditorMaybe` hook and ensure the `editor` exists.");return t},Y=()=>h().editor,W=o.createContext(null),K=({children:t})=>{const[e,c]=o.useState(()=>({setRefCanvas(s){c(r=>({...r,refCanvas:s}))},setCustomModal(s){c(r=>({...r,customModal:s}))},setCustomAssets(s){c(r=>({...r,customAssets:s}))},setCustomBlocks(s){c(r=>({...r,customBlocks:s}))},setCustomRte(s){c(r=>({...r,customRte:s}))},setCustomStyles(s){c(r=>({...r,customStyles:s}))},setCustomLayers(s){c(r=>({...r,customLayers:s}))},setCustomSelectors(s){c(r=>({...r,customSelectors:s}))},setCustomTraits(s){c(r=>({...r,customTraits:s}))},setReady(s){c(r=>({...r,ready:s}))}}));return f.jsx(W.Provider,{value:e,children:t})},E=()=>{const t=o.useContext(W);if(!t)throw new Error("useEditorOptions must be used within EditorOptionsProvider");return t};function V(...t){return(Array.isArray(t[0])?t[0]:[...t]).filter(Boolean).join(" ")}function v(t){return typeof t=="function"}function y(){}const q=t=>typeof t=="string",ee=async t=>{const e=document.createElement("link");e.href=t,e.rel="stylesheet",document.head.appendChild(e)},G=t=>{const e=q(t)?{id:t,src:t}:t;return new Promise((c,s)=>{const r=document.createElement("script");if(document.querySelector(`script[src="${e.src}"]`))return c(e.id);r.src=e.src,r.onload=()=>c(e.id),r.onerror=()=>s(e.id),document.head.appendChild(r)})},te=t=>{const e=t.map(c=>G(c));return Promise.allSettled(e)},N=t=>function(){const e=o.useRef(null);return o.useEffect(()=>{const{current:c}=e;c&&(q(t)?c.innerHTML=t:c.appendChild(t))},[e.current]),f.jsx("div",{ref:e})},D=new WeakMap;function x(t){if(!t)return()=>null;const e=D.get(t);if(e)return e;const c=function({children:s}){return Z.createPortal(s,t)};return D.set(t,c),c}const ie=o.memo(function({children:t}){const{editor:e}=h(),c=E(),[s,r]=o.useState(!1),[n,u]=o.useState({assets:[],types:[],close:()=>{},select:()=>{},Container:()=>null});return o.useEffect(()=>{if(!e)return;const a=e.Assets.events.custom,i=({open:d,assets:m,types:g,select:p,close:l,container:C})=>{d&&u({assets:m,types:g,select:p,close:l,Container:x(C)}),r(d)};return e.on(a,i),()=>{e.off(a,i)}},[e]),o.useEffect(()=>c.setCustomAssets(!0),[]),e&&v(t)?t({open:s,...n}):null}),le=o.memo(function({children:t}){const{editor:e}=h(),c=E(),[s,r]=o.useState(()=>({blocks:[],dragStart:y,dragStop:y,mapCategoryBlocks:new Map,Container:()=>null}));return o.useEffect(()=>{if(!e)return;const n=e.Blocks.events.custom,u=({blocks:a,container:i,dragStart:d,dragStop:m})=>{const g=a.reduce((p,l)=>{const C=l.getCategoryLabel(),j=p.get(C);return j?j.push(l):p.set(C,[l]),p},new Map);r({blocks:a,dragStart:d,dragStop:m,mapCategoryBlocks:g,Container:x(i)})};return e.on(n,u),e.Blocks.__trgCustom(),()=>{e.off(n,u)}},[e]),o.useEffect(()=>c.setCustomBlocks(!0),[]),e&&v(t)?t(s):null});function de({children:t,...e}){const c=E(),s=o.useRef(null);return o.useEffect(()=>{s.current&&c.setRefCanvas(s.current)},[s.current]),f.jsx("div",{...e,ref:s,children:t})}const fe=o.memo(function({children:t}){const{editor:e}=h(),[c,s]=o.useState(()=>({devices:[],selected:"",select:y}));return o.useEffect(()=>{if(!e)return;const{Devices:r}=e,n=r.events.all,u=()=>{var a;s({devices:r.getDevices(),selected:(a=r.getSelected())==null?void 0:a.id,select:i=>r.select(i)})};return e.on(n,u),u(),()=>{e.off(n,u)}},[e]),e&&v(t)?t(c):null}),se=t=>!!(t&&!Array.isArray(t)&&typeof t=="object");async function re(t){const e=t.map(({id:n,src:u})=>({id:n,src:u})),c=t.reduce((n,u)=>(n[u.id]=u,n),{}),s=[],r=[];return(await te(e)).forEach(n=>{n.status==="fulfilled"?s.push(c[n.value]):r.push(c[n.reason])}),{loaded:s,failed:r}}const oe=async t=>{const e=[...t],c={};if(e.length){const s={},r=[];if(e.forEach((n,u)=>{se(n)&&(s[n.id]={index:u},r.push(n))}),r.length){const{loaded:n}=await re(r);n.forEach(({id:u,options:a})=>{s[u].loaded=!0,c[u]=a||{}})}Object.keys(s).forEach(n=>{const u=s[n];u.loaded?e[u.index]=n:e[u.index]=!1})}return{plugins:e.filter(Boolean),pluginOptions:c}},ne=o.memo(function({children:t,className:e,style:c,options:s={},plugins:r=[],grapesjs:n,grapesjsCss:u,onEditor:a=y,onReady:i,onUpdate:d,waitReady:m,...g}){const{setEditor:p}=h(),l=E(),[C,j]=o.useState(!1),k=o.useRef(null);o.useEffect(()=>{if(!l.ready||!k.current)return;const J=k.current,R=l.refCanvas;let S,B={},L=[];const T=M=>{const Q={height:"100%",...s,plugins:[...L,...s.plugins||[]],pluginsOpts:{...s.pluginsOpts,...B},modal:{...s.modal,custom:!!l.customModal},assetManager:{...s.assetManager,custom:!!l.customAssets},styleManager:{...s.styleManager,custom:!!l.customStyles},blockManager:{...s.blockManager,custom:!!l.customBlocks},richTextEditor:{...s.richTextEditor,custom:!!l.customRte},layerManager:{...s.layerManager,custom:!!l.customLayers},traitManager:{...s.traitManager,custom:!!l.customTraits},selectorManager:{...s.selectorManager,custom:!!l.customSelectors},container:R||J,customUI:!!R,...R?{panels:{defaults:[]}}:{}};S=M.init(Q),p(S),a(S),d&&S.on("update",()=>{d(S.getProjectData(),S)}),S.onReady(()=>{j(!0),i==null||i(S)})};return(async()=>{u&&await ee(u);const M=await oe(r);L=M.plugins,B=M.pluginOptions,typeof n=="string"?(await G(n),T(window.grapesjs)):T(n)})(),()=>S==null?void 0:S.destroy()},[l.ready]);const b=s.height??"100%",O=s.width??"100%",P=V("gjs-editor-wrapper",e),A=m&&!C,_=o.useMemo(()=>({...c,height:b,width:O}),[b,O,c]),H=o.useMemo(()=>({..._,...A?{opacity:0,width:0,height:0}:{}}),[_,A]);return f.jsxs(f.Fragment,{children:[m&&!C?f.jsx("div",{className:P,style:_,children:m}):null,f.jsx("div",{...g,ref:k,className:P,style:H,children:t})]})}),ce=o.memo(function(){const t=E();return o.useEffect(()=>t.setReady(!0),[]),f.jsx(f.Fragment,{})}),me=o.memo(function({children:t,...e}){return f.jsx(z,{children:f.jsx(K,{children:f.jsxs(ne,{...e,children:[t,f.jsx(ce,{})]})})})}),pe=o.memo(function({children:t}){const{editor:e}=h(),c=E(),[s,r]=o.useState(()=>({root:void 0,Container:()=>null}));return o.useEffect(()=>{if(!e)return;const{Layers:n}=e,u=n.events.custom,a=({container:i})=>{r({root:n.getRoot(),Container:x(i)})};return e.on(u,a),n.__trgCustom({}),()=>{e.off(u,a)}},[e]),o.useEffect(()=>c.setCustomLayers(!0),[]),e&&v(t)?t(s):null}),ge=o.memo(function({children:t}){const{editor:e}=h(),c=E(),[s,r]=o.useState(!1),[n,u]=o.useState({title:f.jsx(f.Fragment,{}),content:f.jsx(f.Fragment,{}),attributes:{},close:y});return o.useEffect(()=>{if(!e)return;const a="modal",i=({open:d,title:m,content:g,close:p,attributes:l})=>{d&&u({title:o.createElement(N(m)),content:o.createElement(N(g)),attributes:l,close:p}),r(d)};return e.on(a,i),()=>{e.off(a,i)}},[e]),o.useEffect(()=>c.setCustomModal(!0),[]),e&&typeof t=="function"?t({open:s,...n}):null}),he=o.memo(function({children:t}){const{editor:e}=h(),[c,s]=o.useState(()=>({pages:[],selected:void 0,select:y,add:y,remove:y}));return o.useEffect(()=>{if(!e)return;const{Pages:r}=e,n=r.events.all,u=()=>{s({pages:r.getAll(),selected:r.getSelected(),select:(...a)=>r.select(...a),add:(...a)=>r.add(...a),remove:(...a)=>r.remove(...a)})};return e.on(n,u),u(),()=>{e.off(n,u)}},[e]),e&&v(t)?t(c):null}),ye=o.memo(function({children:t}){const{editor:e}=h(),c=E(),[s,r]=o.useState(()=>({selectors:[],states:[],selectedState:"",targets:[],addSelector:y,removeSelector:y,setState:y,Container:()=>null}));return o.useEffect(()=>{if(!e)return;const{Selectors:n}=e,u=n.events.custom,a=({container:i})=>{r({selectors:n.getSelected(),states:n.getStates(),selectedState:n.getState(),targets:n.getSelectedTargets().map(d=>d.getSelectorsString()),addSelector:(...d)=>n.addSelected(...d),removeSelector:(...d)=>n.removeSelected(...d),setState:(...d)=>n.setState(...d),Container:x(i)})};return e.on(u,a),()=>{e.off(u,a)}},[e]),o.useEffect(()=>c.setCustomSelectors(!0),[]),e&&v(t)?t(s):null}),Se=o.memo(function({children:t}){const{editor:e}=h(),c=E(),[s,r]=o.useState(()=>({sectors:[],Container:()=>null}));return o.useEffect(()=>{if(!e)return;const{Styles:n}=e,u=n.events.custom,a=({container:i})=>{r({sectors:n.getSectors({visible:!0}),Container:x(i)})};return e.on(u,a),()=>{e.off(u,a)}},[e]),o.useEffect(()=>c.setCustomStyles(!0),[]),e&&v(t)?t(s):null}),Ee=o.memo(function({children:t}){const{editor:e}=h(),c=E(),[s,r]=o.useState(()=>({traits:[],Container:()=>null}));return o.useEffect(()=>{if(!e)return;const{Traits:n}=e,u=n.events.custom,a=({container:i})=>{r({traits:n.getCurrent(),Container:x(i)})};return e.on(u,a),n.__trgCustom(),()=>{e.off(u,a)}},[e]),o.useEffect(()=>c.setCustomTraits(!0),[]),e&&v(t)?t(s):null}),ve=({children:t})=>Y()?f.jsx(f.Fragment,{children:t}):null;export{me as G,ge as H,fe as J,he as K,ae as N,Ee as Q,le as U,ie as V,ye as X,Se as Z,ve as e,de as q,pe as z};

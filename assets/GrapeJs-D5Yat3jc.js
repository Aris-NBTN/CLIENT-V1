import{r as n,R as Q,w as X}from"./index-DI1ELRnN.js";var I={exports:{}},w={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var F;function Y(){if(F)return w;F=1;var t=Q,e=Symbol.for("react.element"),c=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,r=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function u(a,i,d){var f,g={},p=null,l=null;d!==void 0&&(p=""+d),i.key!==void 0&&(p=""+i.key),i.ref!==void 0&&(l=i.ref);for(f in i)s.call(i,f)&&!o.hasOwnProperty(f)&&(g[f]=i[f]);if(a&&a.defaultProps)for(f in i=a.defaultProps,i)g[f]===void 0&&(g[f]=i[f]);return{$$typeof:e,type:a,key:p,ref:l,props:g,_owner:r.current}}return w.Fragment=c,w.jsx=u,w.jsxs=u,w}I.exports=Y();var m=I.exports;const U=n.createContext(null),z=({children:t})=>{const[e,c]=n.useState({setEditor:s=>{c(r=>({...r,editor:s}))}});return m.jsx(U.Provider,{value:e,children:t})},y=()=>{const t=n.useContext(U);if(!t)throw new Error("useEditorInstance must be used within EditorInstanceProvider");return t},G=n.createContext(null),Z=({children:t})=>{const[e,c]=n.useState(()=>({setRefCanvas(s){c(r=>({...r,refCanvas:s}))},setCustomModal(s){c(r=>({...r,customModal:s}))},setCustomAssets(s){c(r=>({...r,customAssets:s}))},setCustomBlocks(s){c(r=>({...r,customBlocks:s}))},setCustomRte(s){c(r=>({...r,customRte:s}))},setCustomStyles(s){c(r=>({...r,customStyles:s}))},setCustomLayers(s){c(r=>({...r,customLayers:s}))},setCustomSelectors(s){c(r=>({...r,customSelectors:s}))},setCustomTraits(s){c(r=>({...r,customTraits:s}))},setReady(s){c(r=>({...r,ready:s}))}}));return m.jsx(G.Provider,{value:e,children:t})},C=()=>{const t=n.useContext(G);if(!t)throw new Error("useEditorOptions must be used within EditorOptionsProvider");return t};function K(...t){return(Array.isArray(t[0])?t[0]:[...t]).filter(Boolean).join(" ")}function E(t){return typeof t=="function"}function h(){}const W=t=>typeof t=="string",V=async t=>{const e=document.createElement("link");e.href=t,e.rel="stylesheet",document.head.appendChild(e)},$=t=>{const e=W(t)?{id:t,src:t}:t;return new Promise((c,s)=>{const r=document.createElement("script");if(document.querySelector(`script[src="${e.src}"]`))return c(e.id);r.src=e.src,r.onload=()=>c(e.id),r.onerror=()=>s(e.id),document.head.appendChild(r)})},ee=t=>{const e=t.map(c=>$(c));return Promise.allSettled(e)},D=t=>function(){const e=n.useRef(null);return n.useEffect(()=>{const{current:c}=e;c&&(W(t)?c.innerHTML=t:c.appendChild(t))},[e.current]),m.jsx("div",{ref:e})},N=new WeakMap;function x(t){if(!t)return()=>null;const e=N.get(t);if(e)return e;const c=function({children:s}){return X.createPortal(s,t)};return N.set(t,c),c}n.memo(function({children:t}){const{editor:e}=y(),c=C(),[s,r]=n.useState(!1),[o,u]=n.useState({assets:[],types:[],close:()=>{},select:()=>{},Container:()=>null});return n.useEffect(()=>{if(!e)return;const a=e.Assets.events.custom,i=({open:d,assets:f,types:g,select:p,close:l,container:v})=>{d&&u({assets:f,types:g,select:p,close:l,Container:x(v)}),r(d)};return e.on(a,i),()=>{e.off(a,i)}},[e]),n.useEffect(()=>c.setCustomAssets(!0),[]),e&&E(t)?t({open:s,...o}):null});n.memo(function({children:t}){const{editor:e}=y(),c=C(),[s,r]=n.useState(()=>({blocks:[],dragStart:h,dragStop:h,mapCategoryBlocks:new Map,Container:()=>null}));return n.useEffect(()=>{if(!e)return;const o=e.Blocks.events.custom,u=({blocks:a,container:i,dragStart:d,dragStop:f})=>{const g=a.reduce((p,l)=>{const v=l.getCategoryLabel(),j=p.get(v);return j?j.push(l):p.set(v,[l]),p},new Map);r({blocks:a,dragStart:d,dragStop:f,mapCategoryBlocks:g,Container:x(i)})};return e.on(o,u),e.Blocks.__trgCustom(),()=>{e.off(o,u)}},[e]),n.useEffect(()=>c.setCustomBlocks(!0),[]),e&&E(t)?t(s):null});n.memo(function({children:t}){const{editor:e}=y(),[c,s]=n.useState(()=>({devices:[],selected:"",select:h}));return n.useEffect(()=>{if(!e)return;const{Devices:r}=e,o=r.events.all,u=()=>{var a;s({devices:r.getDevices(),selected:(a=r.getSelected())==null?void 0:a.id,select:i=>r.select(i)})};return e.on(o,u),u(),()=>{e.off(o,u)}},[e]),e&&E(t)?t(c):null});const te=t=>!!(t&&!Array.isArray(t)&&typeof t=="object");async function se(t){const e=t.map(({id:o,src:u})=>({id:o,src:u})),c=t.reduce((o,u)=>(o[u.id]=u,o),{}),s=[],r=[];return(await ee(e)).forEach(o=>{o.status==="fulfilled"?s.push(c[o.value]):r.push(c[o.reason])}),{loaded:s,failed:r}}const re=async t=>{const e=[...t],c={};if(e.length){const s={},r=[];if(e.forEach((o,u)=>{te(o)&&(s[o.id]={index:u},r.push(o))}),r.length){const{loaded:o}=await se(r);o.forEach(({id:u,options:a})=>{s[u].loaded=!0,c[u]=a||{}})}Object.keys(s).forEach(o=>{const u=s[o];u.loaded?e[u.index]=o:e[u.index]=!1})}return{plugins:e.filter(Boolean),pluginOptions:c}},oe=n.memo(function({children:t,className:e,style:c,options:s={},plugins:r=[],grapesjs:o,grapesjsCss:u,onEditor:a=h,onReady:i,onUpdate:d,waitReady:f,...g}){const{setEditor:p}=y(),l=C(),[v,j]=n.useState(!1),_=n.useRef(null);n.useEffect(()=>{if(!l.ready||!_.current)return;const H=_.current,R=l.refCanvas;let S,B={},L=[];const T=M=>{const J={height:"100%",...s,plugins:[...L,...s.plugins||[]],pluginsOpts:{...s.pluginsOpts,...B},modal:{...s.modal,custom:!!l.customModal},assetManager:{...s.assetManager,custom:!!l.customAssets},styleManager:{...s.styleManager,custom:!!l.customStyles},blockManager:{...s.blockManager,custom:!!l.customBlocks},richTextEditor:{...s.richTextEditor,custom:!!l.customRte},layerManager:{...s.layerManager,custom:!!l.customLayers},traitManager:{...s.traitManager,custom:!!l.customTraits},selectorManager:{...s.selectorManager,custom:!!l.customSelectors},container:R||H,customUI:!!R,...R?{panels:{defaults:[]}}:{}};S=M.init(J),p(S),a(S),d&&S.on("update",()=>{d(S.getProjectData(),S)}),S.onReady(()=>{j(!0),i==null||i(S)})};return(async()=>{u&&await V(u);const M=await re(r);L=M.plugins,B=M.pluginOptions,typeof o=="string"?(await $(o),T(window.grapesjs)):T(o)})(),()=>S==null?void 0:S.destroy()},[l.ready]);const b=s.height??"100%",O=s.width??"100%",P=K("gjs-editor-wrapper",e),A=f&&!v,k=n.useMemo(()=>({...c,height:b,width:O}),[b,O,c]),q=n.useMemo(()=>({...k,...A?{opacity:0,width:0,height:0}:{}}),[k,A]);return m.jsxs(m.Fragment,{children:[f&&!v?m.jsx("div",{className:P,style:k,children:f}):null,m.jsx("div",{...g,ref:_,className:P,style:q,children:t})]})}),ne=n.memo(function(){const t=C();return n.useEffect(()=>t.setReady(!0),[]),m.jsx(m.Fragment,{})}),ue=n.memo(function({children:t,...e}){return m.jsx(z,{children:m.jsx(Z,{children:m.jsxs(oe,{...e,children:[t,m.jsx(ne,{})]})})})});n.memo(function({children:t}){const{editor:e}=y(),c=C(),[s,r]=n.useState(()=>({root:void 0,Container:()=>null}));return n.useEffect(()=>{if(!e)return;const{Layers:o}=e,u=o.events.custom,a=({container:i})=>{r({root:o.getRoot(),Container:x(i)})};return e.on(u,a),o.__trgCustom({}),()=>{e.off(u,a)}},[e]),n.useEffect(()=>c.setCustomLayers(!0),[]),e&&E(t)?t(s):null});n.memo(function({children:t}){const{editor:e}=y(),c=C(),[s,r]=n.useState(!1),[o,u]=n.useState({title:m.jsx(m.Fragment,{}),content:m.jsx(m.Fragment,{}),attributes:{},close:h});return n.useEffect(()=>{if(!e)return;const a="modal",i=({open:d,title:f,content:g,close:p,attributes:l})=>{d&&u({title:n.createElement(D(f)),content:n.createElement(D(g)),attributes:l,close:p}),r(d)};return e.on(a,i),()=>{e.off(a,i)}},[e]),n.useEffect(()=>c.setCustomModal(!0),[]),e&&typeof t=="function"?t({open:s,...o}):null});n.memo(function({children:t}){const{editor:e}=y(),[c,s]=n.useState(()=>({pages:[],selected:void 0,select:h,add:h,remove:h}));return n.useEffect(()=>{if(!e)return;const{Pages:r}=e,o=r.events.all,u=()=>{s({pages:r.getAll(),selected:r.getSelected(),select:(...a)=>r.select(...a),add:(...a)=>r.add(...a),remove:(...a)=>r.remove(...a)})};return e.on(o,u),u(),()=>{e.off(o,u)}},[e]),e&&E(t)?t(c):null});n.memo(function({children:t}){const{editor:e}=y(),c=C(),[s,r]=n.useState(()=>({selectors:[],states:[],selectedState:"",targets:[],addSelector:h,removeSelector:h,setState:h,Container:()=>null}));return n.useEffect(()=>{if(!e)return;const{Selectors:o}=e,u=o.events.custom,a=({container:i})=>{r({selectors:o.getSelected(),states:o.getStates(),selectedState:o.getState(),targets:o.getSelectedTargets().map(d=>d.getSelectorsString()),addSelector:(...d)=>o.addSelected(...d),removeSelector:(...d)=>o.removeSelected(...d),setState:(...d)=>o.setState(...d),Container:x(i)})};return e.on(u,a),()=>{e.off(u,a)}},[e]),n.useEffect(()=>c.setCustomSelectors(!0),[]),e&&E(t)?t(s):null});n.memo(function({children:t}){const{editor:e}=y(),c=C(),[s,r]=n.useState(()=>({sectors:[],Container:()=>null}));return n.useEffect(()=>{if(!e)return;const{Styles:o}=e,u=o.events.custom,a=({container:i})=>{r({sectors:o.getSectors({visible:!0}),Container:x(i)})};return e.on(u,a),()=>{e.off(u,a)}},[e]),n.useEffect(()=>c.setCustomStyles(!0),[]),e&&E(t)?t(s):null});n.memo(function({children:t}){const{editor:e}=y(),c=C(),[s,r]=n.useState(()=>({traits:[],Container:()=>null}));return n.useEffect(()=>{if(!e)return;const{Traits:o}=e,u=o.events.custom,a=({container:i})=>{r({traits:o.getCurrent(),Container:x(i)})};return e.on(u,a),o.__trgCustom(),()=>{e.off(u,a)}},[e]),n.useEffect(()=>c.setCustomTraits(!0),[]),e&&E(t)?t(s):null});export{ue as G};

import{r as h,j as e,f as V,U as re,a as le,c as ne,t as ie,d as q,T as oe,ab as ce,Q as de,e as me,ac as u,ai as he,aj as z,ak as pe,al as ue,am as ge,an as xe}from"./index-CHCWDRZ2.js";import{b7 as je}from"./Layout-BzFU_PBd.js";import{E as $,T as D}from"./Table-D6tImSps.js";import{F as O,a as E,c as R,b as be}from"./jspdf.es.min-B7pOdYCe.js";import{f as ye,F as Ce,g as fe,d as B,h as Ne}from"./Format-DsbWSY0F.js";import"./html2canvas.esm-CBrSDip1.js";import{M as we,a as Fe}from"./index-B_fK6BkB.js";import{U as ve}from"./index-83UCx3FS.js";import{I as Ie}from"./index-BEHM9N6w.js";import{R as ke,T as Se}from"./index-DbC7zbte.js";import{T as U,k as Te,a as n,b as P,l as Ae}from"./index-DdTMwFaj.js";import{F as s}from"./index-BqG20MTe.js";import{B as w}from"./TextArea-DAd0mUFG.js";import{M as L}from"./index-BXmm9gNd.js";import{I as j}from"./index-Dh5HinNk.js";import{S as m}from"./index-C98fPcR7.js";import{R as _,C as b}from"./row-BhNtE9JD.js";import"./index-B6f4Qoqx.js";import"./CheckOutlined-OG0Tjpvu.js";import"./addEventListener-BVncUb8Z.js";import"./iconUtil-c4420y7p.js";import"./EllipsisOutlined-DFwrhZRX.js";import"./Overflow-CwOSffrJ.js";import"./index-CqbxIKOB.js";import"./index-gc3TQPig.js";import"./index-DuqbRpoy.js";import"./SearchOutlined-CsRNx9J2.js";import"./index-D0JY5H3L.js";import"./ActionButton-OOPoV2If.js";import"./index-B6MxgLcR.js";import"./progress-CFbhnIB8.js";import"./index-BvehVlEt.js";const De=y=>new Promise((d,p)=>{const o=new FileReader;o.readAsDataURL(y),o.onload=()=>d(o.result),o.onerror=l=>p(l)}),G=({limit:y,apiUpload:d,body:p,fileLists:o,name:l})=>{const[r,F]=h.useState(!1),[v,I]=h.useState(""),g=o==="undefined"?[]:[{uid:o,name:o,status:"done",url:`${V}/uploads/${o}`}],[k,x]=h.useState(g);h.useEffect(()=>{x(g)},[o]);const T=async c=>{!c.url&&!c.preview&&(c.preview=await De(c.originFileObj)),I(c.url||c.preview),F(!0)},C=({fileList:c,file:f})=>{x(c),f.status==="done"&&re.put({id:p,[l]:f.response})},t=e.jsxs("button",{style:{border:0,background:"none"},type:"button",children:[e.jsx(ke,{}),e.jsx("div",{style:{marginTop:8},children:"Tải ảnh lên"})]});return e.jsxs(e.Fragment,{children:[e.jsx(ve,{data:{folder:"123"},action:d,listType:"picture-card",fileList:k,onPreview:T,onChange:C,children:k.length>=y?null:t}),v&&e.jsx(Ie,{wrapperStyle:{display:"none"},preview:{visible:r,onVisibleChange:c=>F(c),afterOpenChange:c=>!c&&I("")},src:v})]})},da=()=>{const y=le(),d=ne(),[p]=s.useForm(),[o]=s.useForm(),[l]=s.useForm(),{token:{colorPrimary:r}}=ie.useToken(),F=s.useWatch("price",p),v=s.useWatch("sale",p),[I,g]=h.useState(!1),[k,x]=h.useState(!1),[T,C]=h.useState(!1),[t,c]=h.useState(""),{courses:f,loading:S}=q(a=>a.courses),{categoryCourses:i,loading:A}=q(a=>a.categoryCourses),H=h.useMemo(()=>f.map(a=>({...a,key:a._id})),[f]),J=h.useMemo(()=>i.map(a=>({...a,key:a._id})),[i]),W=[{title:"Tên khóa học",dataIndex:"name",width:"10%",type:"text",editable:!0,ellipsis:{showTitle:!0},...O({dataIndex:"name"}),render:a=>e.jsx(oe,{placement:"top",title:a,children:a})},{title:"Link",dataIndex:"slug",width:"10%",type:"text",editable:!1,ellipsis:{showTitle:!0},...O({dataIndex:"slug"}),render:a=>e.jsx(e.Fragment,{children:e.jsx(U.Paragraph,{className:"!mb-0",ellipsis:{suffix:""},copyable:{text:`/course/${a}`},children:a})})},{title:"Danh mục",dataIndex:"category",width:"10%",type:"select",editable:!0,optionSelect:Array.isArray(i)&&i.length>0?i==null?void 0:i.map(a=>({label:a.category,value:a._id})):[],...Array.isArray(i)&&i.length>0?E("category",i.map(a=>({text:a.category,value:a._id}))):{},render:a=>a&&i&&Array.isArray(i)&&i.length>0?ye(a,i,"category"):null},{title:"Giá",dataIndex:"price",width:"7%",type:"price",editable:!0,...R({dataIndex:"price",type:"number"}),render:a=>Ce(a)},{title:"Giảm",dataIndex:"sale",width:"5%",type:"percent",editable:!0,...R({dataIndex:"sale",type:"number"}),render:a=>fe(a)},{title:"Trang thái",dataIndex:"status",width:"8%",type:"select",optionSelect:[{label:"Đang bán",value:"Đang bán"},{label:"Chưa bán",value:"Chưa bán"}],editable:!0,...E("status",[{value:"Đang bán",text:"Đang bán"},{value:"Chưa bán",text:"Chưa bán"}])},{title:"Sao",dataIndex:"star",width:"6%",type:"select",optionSelect:[{label:"3",value:"3"},{label:"4",value:"4"},{label:"4.5",value:"4.5"},{label:"5",value:"5"}],editable:!0},{title:"Ngày tạo",dataIndex:"createdAt",width:"8%",...be({dataIndex:"createdAt"}),render:a=>B(a)},{title:"Cập nhập",dataIndex:"updatedAt",width:"8%",render:a=>Ne(a)},{title:"Thông tin",dataIndex:"info",width:"7%",render:(a,N)=>e.jsx("div",{className:"flex justify-center",children:e.jsx(w,{type:"primary",ghost:!0,onClick:()=>{l.setFieldsValue(N),g(!0),c(N)},children:"Thông tin"})})}],K=[{title:"Tên danh mục",dataIndex:"category",width:"70%",type:"text",editable:!0,...O({dataIndex:"category"})}],Q=a=>{u(d,he(a),()=>{x(!1),p.resetFields()})},X=a=>{u(d,z(a))},Y=a=>{a.id=a.key,u(d,z(a),()=>{g(!1),l.resetFields()})},Z=a=>{u(d,pe(a))},ee=a=>{u(d,ue(a),()=>{C(!1),o.resetFields()})},ae=a=>{u(d,ge(a))},te=a=>{u(d,xe(a))};return h.useEffect(()=>{S===!0&&d(ce())},[]),h.useEffect(()=>{A&&d(de())},[]),h.useEffect(()=>{(()=>{const N=p.getFieldValue("price")||0,se=p.getFieldValue("sale")||0,M=N-N*se/100;p.setFieldsValue({priceSale:M>=0?M:0})})()},[F,v]),e.jsxs(je,{header:e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex items-center",children:e.jsx("h6",{className:"mb-0",children:"KHÓA HỌC"})})}),button:e.jsxs(e.Fragment,{children:[e.jsx(w,{type:"primary",onClick:()=>{C(!0)},children:" Thêm danh mục"}),e.jsx(w,{type:"primary",onClick:()=>x(!0),children:"Thêm khóa học"})]}),children:[e.jsx($,{loading:S,data:H,columns:W,onSave:X,onDelete:Z,button:a=>e.jsx("div",{className:"flex gap-3",children:e.jsx(we,{onClick:()=>y(`/admin/course/${a.slug}`),size:20,color:"red"})})}),e.jsx(L,{title:e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[" Thông tin khóa học: ",e.jsx(U.Text,{type:"danger",children:l.getFieldValue("name")})]}),e.jsx(w,{className:"me-4",icon:t!=null&&t.seo?e.jsx(Te,{size:20,color:r}):e.jsx(Fe,{size:20,color:"red"}),onClick:()=>{const a={"@context":"https://schema.org/","@id":t==null?void 0:t.slug,"@type":"Course",name:t==null?void 0:t.name,description:t==null?void 0:t.description,publisher:{"@type":"Organization",name:"Tên công ty",url:"Link trang chủ trang web"},provider:{"@type":"Organization",name:"Tên công ty",url:"Link trang chủ trang web"},image:["https://example.com/photos/1x1/photo.jpg"],aggregateRating:{"@type":"AggregateRating",ratingValue:t==null?void 0:t.star,ratingCount:2e3,reviewCount:1200},offers:[{"@type":"Offer",category:t==null?void 0:t.category,priceCurrency:"VND",price:t==null?void 0:t.price}],hasCourseInstance:[{"@type":"CourseInstance",courseMode:"Blended",location:"HoChiMinh University",courseSchedule:{"@type":"Schedule",duration:"PT3H",repeatFrequency:"Daily",repeatCount:31},instructor:[{"@type":"Person",name:"Nguyen Bac Trung Nam",description:"Professor at X-University",image:"http://example.com/person.jpg"}]},{"@type":"CourseInstance",courseMode:"Online",courseWorkload:"3D"}],totalHistoricalEnrollment:400,datePublished:B(t==null?void 0:t.createdAt),educationalLevel:"Advanced",about:["3D Modeling","3D environment","3D artist"],teaches:["Practice and apply systems thinking to plan for change","Understand how memory allocation works."],financialAidEligible:"Scholarship Available",inLanguage:"vn",availableLanguage:["vn","es"],coursePrerequisites:["Basic understanding of C++ up to arrays and functions.","https://www.example.com/beginnerCpp"],educationalCredentialAwarded:[{"@type":"EducationalOccupationalCredential",name:"3D Modeling Certificate",url:"https://www.example.com/3d-modeling-certificate",credentialCategory:"Certificate"}]};me("ldjs","Tạo file thành công","Đã tạo file LD+JS, vui lòng cập nhập!"),l.setFieldValue("seo",a)},children:t!=null&&t.seo?"Đã tạo file LD+JS":"Tạo file LD+JS"})]})}),centered:!0,open:I,maskClosable:!1,onOk:()=>l.submit(),onCancel:()=>{g(!1),l.resetFields()},confirmLoading:S,width:800,children:e.jsxs(s,{form:l,name:"customForm",layout:"vertical",onFinish:Y,children:[e.jsx(s.Item,{className:"mb-0 hidden",name:"key",children:e.jsx(j,{className:"mb-2"})}),e.jsx(s.Item,{className:"mb-2",name:"title",label:"Tiêu đề",children:e.jsx(j,{size:"large",className:"mb-2",placeholder:"Nhập tiêu đề"})}),e.jsx(s.Item,{className:"mb-2",name:"prerequisite",label:"Điều kiện tiên quyết",children:e.jsx(m,{size:"large",className:"w-full mb-2",placeholder:"Chọn & nhập điều kiện tiên quyết",mode:"tags",tokenSeparators:[","]})}),e.jsx(s.Item,{className:"mb-2",name:"customer",label:"Đối tượng khách hàng",children:e.jsx(m,{size:"large",className:"w-full mb-2",placeholder:"Chọn & nhập đối tượng khách hàng",mode:"tags",tokenSeparators:[","]})}),e.jsx(s.Item,{className:"mb-2",name:"output",label:"Tiêu chí đầu ra",children:e.jsx(m,{size:"large",className:"w-full mb-2",placeholder:"Chọn & nhập tiêu chí đầu ra",mode:"tags",tokenSeparators:[","]})}),e.jsx(s.Item,{className:"mb-2",name:"benefit",label:"Lợi ích từ khóa học",children:e.jsx(m,{size:"large",className:"w-full mb-2",placeholder:"Chọn & nhập lợi ích",mode:"tags",tokenSeparators:[","]})}),e.jsx(s.Item,{className:"mb-0 hidden",name:"seo",children:e.jsx(j,{className:"mb-2"})}),e.jsxs("div",{className:"flex flex-wrap md:flex-nowrap mt-2 gap-2 justify-center",children:[e.jsx(s.Item,{className:"mb-2",label:"Ảnh bìa",children:e.jsx(G,{apiUpload:`${V}/v1/courser/image`,name:"img",body:l==null?void 0:l.getFieldValue("_id"),fileLists:`${l==null?void 0:l.getFieldValue("img")}`,limit:1})}),e.jsx(s.Item,{className:"mb-2",label:"Ảnh chi tiết",children:e.jsx(G,{apiUpload:`${V}/v1/courser/image`,name:"imgDetail",body:l.getFieldValue("_id"),fileLists:`${l.getFieldValue("imgDetail")}`,limit:1})}),e.jsx(s.Item,{className:"w-full mb-2",name:"description",label:" Mô tả",children:e.jsx(j.TextArea,{size:"large",className:"mb-2",placeholder:"Nhập mô tả",style:{height:100,resize:"none"}})})]})]})}),e.jsx(L,{title:"Khóa học",centered:!0,open:k,onOk:()=>p.submit(),onCancel:()=>x(!1),confirmLoading:S,width:600,children:e.jsxs(s,{form:p,name:"customForm",layout:"vertical",onFinish:Q,children:[e.jsx(s.Item,{className:"mb-2",name:"name",label:"Tên khóa học",rules:[{required:!0,message:"Nhập tên khóa học!"}],children:e.jsx(j,{placeholder:"Nhập tên khóa học"})}),e.jsxs(_,{gutter:[14,14],children:[e.jsx(b,{span:8,children:e.jsx(s.Item,{className:"mb-2",name:"category",label:"Danh mục",rules:[{required:!0,message:"Chọn danh mục!"}],children:e.jsx(m,{options:i.map(a=>({label:a.category,value:a._id})),placeholder:"Chọn danh mục"})})}),e.jsx(b,{span:8,children:e.jsx(s.Item,{className:"mb-2",name:"status",label:"Trạng thái",rules:[{required:!0,message:"Chọn trạng thái!"}],children:e.jsxs(m,{placeholder:"Chọn trạng thái",children:[e.jsx(m.Option,{value:"Đang bán",children:"Đang bán"}),e.jsx(m.Option,{value:"Chưa bán",children:"Chưa bán"})]})})}),e.jsx(b,{span:8,children:e.jsx(s.Item,{className:"mb-2",name:"star",label:"Số sao",rules:[{required:!0,message:"Chọn số sao!"}],children:e.jsxs(m,{placeholder:"Chọn trạng thái",children:[e.jsx(m.Option,{value:"3",children:e.jsxs("div",{className:"flex",children:[e.jsx(n,{color:r}),e.jsx(n,{color:r}),e.jsx(n,{color:r}),e.jsx(P,{color:r}),e.jsx(P,{color:r})]})}),e.jsx(m.Option,{value:"4",children:e.jsxs("div",{className:"flex",children:[e.jsx(n,{color:r}),e.jsx(n,{color:r}),e.jsx(n,{color:r}),e.jsx(n,{color:r}),e.jsx(P,{color:r})]})}),e.jsx(m.Option,{value:"4.5",children:e.jsxs("div",{className:"flex",children:[e.jsx(n,{color:r}),e.jsx(n,{color:r}),e.jsx(n,{color:r}),e.jsx(n,{color:r}),e.jsx(Ae,{color:r})]})}),e.jsx(m.Option,{value:"5",children:e.jsxs("div",{className:"flex",children:[e.jsx(n,{color:r}),e.jsx(n,{color:r}),e.jsx(n,{color:r}),e.jsx(n,{color:r}),e.jsx(n,{color:r})]})})]})})})]}),e.jsxs(_,{gutter:[14,14],children:[e.jsx(b,{span:8,children:e.jsx(s.Item,{className:"mb-0",name:"price",label:"Giá tiền VN",rules:[{required:!0,message:"Nhập giá tiền!"}],children:e.jsx(D,{className:"w-full mb-2",placeholder:"Nhập giá tiền",min:0,step:1e5,parser:a=>a==null?void 0:a.replace(/\$\s?|(,*)/g,""),formatter:a=>`${a}`.replace(/\B(?=(\d{3})+(?!\d))/g,",")})})}),e.jsx(b,{span:8,children:e.jsx(s.Item,{className:"mb-0",name:"sale",label:"Giảm giá %",rules:[{required:!0,message:"Nhập %!"}],children:e.jsx(D,{className:"w-full mb-2",placeholder:"Nhập %",min:0,max:100,step:5})})}),e.jsx(b,{span:8,children:e.jsx(s.Item,{className:"mb-0",label:"Giá sau khi giảm",name:"priceSale",children:e.jsx(D,{className:"w-full mb-2",placeholder:"Giá sau khi giảm",readOnly:!0,min:0,step:1e5,parser:a=>a==null?void 0:a.replace(/\$\s?|(,*)/g,""),formatter:a=>`${a}`.replace(/\B(?=(\d{3})+(?!\d))/g,",")})})})]})]})}),e.jsx(L,{centered:!0,open:T,onCancel:()=>C(!1),footer:null,width:600,children:e.jsx(Se,{centered:!0,items:[{label:"Thêm danh mục",key:"1",children:e.jsx(e.Fragment,{children:e.jsxs(s,{form:o,name:"customForm",layout:"vertical",onFinish:ee,children:[e.jsx(s.Item,{className:"mb-3",name:"category",label:"Tên danh mục",rules:[{required:!0,message:"Nhập tên danh mục!"}],children:e.jsx(j,{placeholder:"Nhập tên danh mục"})}),e.jsx(w,{type:"primary",loading:A,onClick:()=>o.submit(),className:"flex float-end",children:"Thêm danh mục"})]})})},{label:"Chỉnh sửa danh mục",key:"2",children:e.jsx(e.Fragment,{children:e.jsx($,{loading:A,data:J,columns:K,onSave:ae,onDelete:te,width:"20%",scroll:{x:500,y:350}})})}]})})]})};export{da as default};

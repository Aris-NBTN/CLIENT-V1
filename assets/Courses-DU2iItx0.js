import{a as J,c as Q,r as l,d as I,j as e,U as X,o as Y,V as o,a0 as Z,a1 as k,a2 as ee,a3 as ae,a4 as te,a5 as se}from"./index-DlYMrpPW.js";import{b7 as re}from"./Layout-CpjJMsYa.js";import{E as T,T as C}from"./Table-BZPB0-lF.js";import{F as A,a as w,c as S,b as ne}from"./jspdf.es.min-DIvpoIaq.js";import{f as le,F as ie,g as oe,d as me,h as ce}from"./Format-DVssGH0h.js";import"./html2canvas.esm-CBrSDip1.js";import{M as de}from"./index-B9kKYNQ6.js";import{F as t}from"./index-BcyQc9y1.js";import{B as p}from"./button-CE-BZK77.js";import{M as f}from"./index-CO9Q68ww.js";import{T as he}from"./index-BA5SGM9y.js";import{I as c}from"./index-P5rlzTpu.js";import{S as i}from"./index-BYNFFT4D.js";import{R as q,C as d}from"./row-BjQvrOOl.js";import{T as ue}from"./index-BzZmPurf.js";import"./animate-q5OpxXju.js";import"./context-C-Rv8Q9P.js";import"./index-BhRu2L4p.js";import"./index-B0WLfmks.js";import"./index-DJL_NHcj.js";import"./index-DXcoRrUW.js";import"./EllipsisOutlined--Rr4Zdtn.js";import"./Overflow-CkeVNlGt.js";import"./collapse-BbEVqHco.js";import"./useLocale-AUr8qwmz.js";import"./PurePanel-CgvgODcO.js";import"./index-RbKsYPWi.js";import"./responsiveObserver--9lCBinC.js";import"./iconUtil-DQgXce6J.js";import"./compact-item-DVIPdewI.js";import"./index-xGiB6SMK.js";import"./index-DIwEvQnT.js";import"./TextArea-BL_qZjFp.js";import"./index-DWBsL6Py.js";import"./index-BURokasu.js";import"./SearchOutlined-DFBtPtmd.js";import"./index-CKNSBnWp.js";import"./ActionButton-Cwh1PuVf.js";import"./index-Be9Ssfp7.js";const Ze=()=>{const v=J(),r=Q(),[n]=t.useForm(),[g]=t.useForm(),[m]=t.useForm(),D=t.useWatch("price",n),M=t.useWatch("sale",n),[O,x]=l.useState(!1),[V,b]=l.useState(!1),[E,y]=l.useState(!1),{courses:N,loading:h}=I(a=>a.courses),{categoryCourses:s,loading:j}=I(a=>a.categoryCourses),P=l.useMemo(()=>N.map(a=>({...a,key:a._id})),[N]),G=l.useMemo(()=>s.map(a=>({...a,key:a._id})),[s]),B=[{title:"Tên khóa học",dataIndex:"name",width:"10%",type:"text",editable:!0,...A({dataIndex:"name"})},{title:"Danh mục",dataIndex:"category",width:"7%",type:"select",editable:!0,optionSelect:Array.isArray(s)&&s.length>0?s==null?void 0:s.map(a=>({label:a.category,value:a._id})):[],render:a=>a&&s&&Array.isArray(s)&&s.length>0?le(a,s,"category"):null,...Array.isArray(s)&&s.length>0?w("category",s.map(a=>({text:a.category,value:a._id}))):{}},{title:"Giá",dataIndex:"price",width:"7%",type:"price",editable:!0,render:a=>ie(a),...S({dataIndex:"price",type:"number"})},{title:"Giảm %",dataIndex:"sale",width:"6%",type:"percent",editable:!0,render:a=>oe(a),...S({dataIndex:"sale",type:"number"})},{title:"Trang thái",dataIndex:"status",width:"7%",type:"select",optionSelect:[{label:"Đang bán",value:"Đang bán"},{label:"Chưa bán",value:"Chưa bán"}],editable:!0,...w("status",[{value:"Đang bán",text:"Đang bán"},{value:"Chưa bán",text:"Chưa bán"}])},{title:"Ngày tạo",dataIndex:"createdAt",width:"7%",...ne({dataIndex:"createdAt"}),render:a=>me(a)},{title:"Cập nhập",dataIndex:"updatedAt",width:"7%",render:a=>ce(a)},{title:"Thông tin",dataIndex:"info",width:"6%",render:(a,u)=>e.jsx("div",{className:"flex justify-center",children:e.jsx(p,{type:"primary",ghost:!0,onClick:()=>{m.setFieldsValue(u),x(!0)},children:"Thông tin"})})}],_=[{title:"Tên danh mục",dataIndex:"category",width:"70%",type:"text",editable:!0,...A({dataIndex:"category"})}],$=a=>{o(r,Z(a),()=>{b(!1),n.resetFields()})},L=a=>{o(r,k(a))},R=a=>{a.id=a.key,o(r,k(a),()=>{x(!1),m.resetFields()})},z=a=>{o(r,ee(a))},H=a=>{o(r,ae(a),()=>{y(!1),g.resetFields()})},K=a=>{o(r,te(a))},W=a=>{o(r,se(a))};return l.useEffect(()=>{h===!0&&r(X())},[]),l.useEffect(()=>{j&&r(Y())},[]),l.useEffect(()=>{(()=>{const u=n.getFieldValue("price")||0,U=n.getFieldValue("sale")||0,F=u-u*U/100;n.setFieldsValue({priceSale:F>=0?F:0})})()},[D,M]),e.jsxs(re,{header:e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex items-center",children:e.jsx("h6",{className:"mb-0",children:"KHÓA HỌC"})})}),button:e.jsxs(e.Fragment,{children:[e.jsx(p,{type:"primary",onClick:()=>{y(!0)},children:" Thêm danh mục"}),e.jsx(p,{type:"primary",onClick:()=>b(!0),children:"Thêm khóa học"})]}),children:[e.jsx(T,{loading:h,data:P,columns:B,onSave:L,onDelete:z,button:a=>e.jsx("div",{className:"flex gap-3",children:e.jsx(de,{onClick:()=>v(`/admin/course/${a.slug}`),size:20,color:"red"})})}),e.jsx(f,{title:e.jsxs(e.Fragment,{children:["Thông tin khóa học: ",e.jsx(he.Text,{type:"danger",children:m.getFieldValue("name")})]}),centered:!0,open:O,onOk:()=>m.submit(),onCancel:()=>{x(!1),m.resetFields()},confirmLoading:h,width:600,children:e.jsxs(t,{form:m,name:"customForm",layout:"vertical",onFinish:R,children:[e.jsx(t.Item,{className:"mb-0 hidden",name:"key",children:e.jsx(c,{className:"mb-2"})}),e.jsx(t.Item,{className:"mb-2",name:"title",label:"Tiêu đề",rules:[{required:!0,message:"Nhập tiêu đề!"}],children:e.jsx(c,{className:"mb-2",placeholder:"Nhập tiêu đề"})}),e.jsx(t.Item,{className:"mb-2",name:"prerequisite",label:"Điều kiện tiên quyết",rules:[{required:!0,message:"Chọn & nhập điều kiện tiên quyết!"}],children:e.jsx(i,{className:"w-full mb-2",placeholder:"Chọn & nhập điều kiện tiên quyết",mode:"tags",tokenSeparators:[","]})}),e.jsx(t.Item,{className:"mb-2",name:"customer",label:"Đối tượng khách hàng",rules:[{required:!0,message:"Chọn & nhập đối tượng khách hàng!"}],children:e.jsx(i,{className:"w-full mb-2",placeholder:"Chọn & nhập đối tượng khách hàng",mode:"tags",tokenSeparators:[","]})}),e.jsx(t.Item,{className:"mb-2",name:"output",label:"Tiêu chí đầu ra",rules:[{required:!0,message:"Chọn & nhập tiêu chí đầu ra!"}],children:e.jsx(i,{className:"w-full mb-2",placeholder:"Chọn & nhập tiêu chí đầu ra",mode:"tags",tokenSeparators:[","]})}),e.jsx(t.Item,{className:"mb-2",name:"benefit",label:"Lợi ích từ khóa học",rules:[{required:!0,message:"Chọn & nhập lợi ích!"}],children:e.jsx(i,{className:"w-full mb-2",placeholder:"Chọn & nhập lợi ích",mode:"tags",tokenSeparators:[","]})}),e.jsxs("div",{className:"flex mt-2 gap-2",children:[e.jsx(t.Item,{className:"mb-2",name:"benefit",label:"Ảnh",rules:[{required:!0}],children:"123"}),e.jsx(t.Item,{className:"mb-2",name:"img",children:e.jsx(c,{className:"mb-2 hidden"})}),e.jsx(t.Item,{className:"w-full mb-2",name:"description",label:" Mô tả",rules:[{required:!0,message:"Nhập mô tả!"}],children:e.jsx(c.TextArea,{className:"mb-2",placeholder:"Nhập mô tả",style:{height:102,resize:"none"}})})]})]})}),e.jsx(f,{title:"Khóa học",centered:!0,open:V,onOk:()=>n.submit(),onCancel:()=>b(!1),confirmLoading:h,width:600,children:e.jsxs(t,{form:n,name:"customForm",layout:"vertical",onFinish:$,children:[e.jsx(t.Item,{className:"mb-2",name:"name",label:"Tên khóa học",rules:[{required:!0,message:"Nhập tên khóa học!"}],children:e.jsx(c,{placeholder:"Nhập tên khóa học"})}),e.jsxs(q,{gutter:[14,14],children:[e.jsx(d,{span:12,children:e.jsx(t.Item,{className:"mb-2",name:"category",label:"Danh mục",rules:[{required:!0,message:"Chọn danh mục!"}],children:e.jsx(i,{options:s.map(a=>({label:a.category,value:a._id})),placeholder:"Chọn danh mục"})})}),e.jsx(d,{span:12,children:e.jsx(t.Item,{className:"mb-2",name:"status",label:"Trạng thái",rules:[{required:!0,message:"Chọn trạng thái!"}],children:e.jsxs(i,{placeholder:"Chọn trạng thái",children:[e.jsx(i.Option,{value:"Đang bán",children:"Đang bán"}),e.jsx(i.Option,{value:"Chưa bán",children:"Chưa bán"})]})})})]}),e.jsxs(q,{gutter:[14,14],children:[e.jsx(d,{span:8,children:e.jsx(t.Item,{className:"mb-0",name:"price",label:"Giá tiền VN",rules:[{required:!0,message:"Nhập giá tiền!"}],children:e.jsx(C,{className:"w-full mb-2",placeholder:"Nhập giá tiền",min:0,step:1e5,parser:a=>a==null?void 0:a.replace(/\$\s?|(,*)/g,""),formatter:a=>`${a}`.replace(/\B(?=(\d{3})+(?!\d))/g,",")})})}),e.jsx(d,{span:8,children:e.jsx(t.Item,{className:"mb-0",name:"sale",label:"Giảm giá %",rules:[{required:!0,message:"Nhập %!"}],children:e.jsx(C,{className:"w-full mb-2",placeholder:"Nhập %",min:0,max:100,step:5})})}),e.jsx(d,{span:8,children:e.jsx(t.Item,{className:"mb-0",label:"Giá sau khi giảm",name:"priceSale",children:e.jsx(C,{className:"w-full mb-2",placeholder:"Giá sau khi giảm",readOnly:!0,min:0,step:1e5,parser:a=>a==null?void 0:a.replace(/\$\s?|(,*)/g,""),formatter:a=>`${a}`.replace(/\B(?=(\d{3})+(?!\d))/g,",")})})})]})]})}),e.jsx(f,{centered:!0,open:E,onCancel:()=>y(!1),footer:null,width:600,children:e.jsx(ue,{centered:!0,items:[{label:"Thêm danh mục",key:"1",children:e.jsx(e.Fragment,{children:e.jsxs(t,{form:g,name:"customForm",layout:"vertical",onFinish:H,children:[e.jsx(t.Item,{className:"mb-3",name:"category",label:"Tên danh mục",rules:[{required:!0,message:"Nhập tên danh mục!"}],children:e.jsx(c,{placeholder:"Nhập tên danh mục"})}),e.jsx(p,{type:"primary",loading:j,onClick:()=>g.submit(),className:"flex float-end",children:"Thêm danh mục"})]})})},{label:"Chỉnh sửa danh mục",key:"2",children:e.jsx(e.Fragment,{children:e.jsx(T,{loading:j,data:G,columns:_,onSave:K,onDelete:W,width:"20%",scroll:{x:500,y:350}})})}]})})]})};export{Ze as default};

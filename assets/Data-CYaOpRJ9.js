import{a0 as b,c as S,r as j,d as v,bl as I,j as e,a3 as F,W as w}from"./index-bwOTuzAT.js";import{b7 as K}from"./Layout-Csu-sfMs.js";import{F as s}from"./index-nVbZcPSO.js";import{R as g,C as h}from"./row-Cbh7OpyR.js";import{C as i}from"./index-B0tzyh4T.js";import{T as c}from"./index-5Oj6Dx0r.js";import{B as m}from"./TextArea-BSyf-wd8.js";import{M as D}from"./index-B-m8jKNI.js";import{S as n}from"./index-Dlw4ObIR.js";import"./index-DqlZTV-q.js";import"./CheckOutlined--i9GrI_G.js";import"./EllipsisOutlined-_3EUVNj_.js";import"./Overflow-BYLru37j.js";import"./index-vyCTIKQx.js";import"./index-DnPka7B9.js";import"./index-JWdyHt5z.js";import"./index-CR8zkw6M.js";import"./SearchOutlined-Bp-Ap9qm.js";const y="/v1/data",R=async()=>await b.get(`${y}`),T=async l=>await b.post(`${y}`,l),B=async l=>await b.post(`${y}/dow-file`,l),E=async l=>await b.post(`${y}`,l),L={backup:R,restore:T,dowBackupFile:B,dowBackupData:E},se=()=>{const l=S(),[d,a]=j.useState(!1),[u,o]=j.useState(null),[f]=s.useForm(),k=r=>{const p=Object.fromEntries(Object.entries(r).filter(([O,C])=>C!==void 0));Object.keys(p).length>0?(F("restore","Đang khôi phục dữ liệu..."),L.restore({collections:p}).then(()=>{w("restore","Khôi phục dữ liệu thành công!","Dữ liệu đã được khôi phục lại!"),f.resetFields(),a(!1)}).catch(()=>{w("restore","Khôi phục dữ liệu thất bại!","Vui lòng thử lại sau!")})):w("restore","Khôi phục dữ liệu thất bại!","Vui lòng chọn ít nhất 1 bản ghi cần khôi phục!")},{restore:x,loading:N}=v(r=>r.restore),t=j.useMemo(()=>{var r;return(r=x==null?void 0:x.newData)==null?void 0:r.children.map(p=>({label:p.name,value:p.name}))},[x]);return j.useEffect(()=>{N&&l(I({folderName:"uploads/backup"}))},[]),e.jsxs(K,{header:"DỮ LIỆU",children:[e.jsx(g,{gutter:[24,24],children:e.jsx(h,{span:24,children:e.jsx(i,{title:e.jsxs(e.Fragment,{children:["Khôi phục dữ liệu ",e.jsx(c.Link,{className:"text-base",children:"data"})]}),children:e.jsxs(g,{gutter:[24,24],children:[e.jsx(h,{xl:{span:8},lg:{span:12},span:"24",children:e.jsx(i,{className:"h-full",children:e.jsxs("div",{className:"flex flex-wrap justify-between items-center",children:[e.jsx(c.Title,{level:5,className:"!my-0",children:"Khôi phục dữ liệu Website"}),e.jsx(m,{type:"primary",onClick:()=>{a(!0),o("website")},children:" Khôi phục"})]})})}),e.jsx(h,{xl:{span:8},lg:{span:12},span:"24",children:e.jsx(i,{className:"h-full",children:e.jsxs("div",{className:"flex flex-wrap justify-between items-center",children:[e.jsx(c.Title,{level:5,className:"!my-0",children:"Khôi phục dữ liệu người dùng"}),e.jsx(m,{type:"primary",onClick:()=>{a(!0),o("users")},children:" Khôi phục"})]})})}),e.jsx(h,{xl:{span:8},lg:{span:12},span:"24",children:e.jsx(i,{className:"h-full",children:e.jsxs("div",{className:"flex flex-wrap justify-between items-center",children:[e.jsx(c.Title,{level:5,className:"!my-0",children:"Khôi phục dữ liệu khóa học"}),e.jsx(m,{type:"primary",onClick:()=>{a(!0),o("courses")},children:" Khôi phục"})]})})}),e.jsx(h,{xl:{span:8},lg:{span:12},span:"24",children:e.jsx(i,{className:"h-full",children:e.jsxs("div",{className:"flex flex-wrap justify-between items-center",children:[e.jsx(c.Title,{level:5,className:"!my-0",children:"Khôi phục dữ liệu đơn hàng"}),e.jsx(m,{type:"primary",onClick:()=>{a(!0),o("orders")},children:" Khôi phục"})]})})}),e.jsx(h,{xl:{span:8},lg:{span:12},span:"24",children:e.jsx(i,{className:"h-full",children:e.jsxs("div",{className:"flex flex-wrap justify-between items-center",children:[e.jsx(c.Title,{level:5,className:"!my-0",children:"Khôi phục khác"}),e.jsx(m,{type:"primary",onClick:()=>{a(!0),o("others")},children:" Khôi phục"})]})})})]})})})}),e.jsx(D,{title:"Chọn bản ghi cần khôi phục",centered:!0,open:d,onOk:()=>f.submit(),onCancel:()=>a(!1),children:e.jsx(s,{form:f,name:"customRes",layout:"vertical",onFinish:k,children:u=="website"?e.jsxs(e.Fragment,{children:[e.jsx(s.Item,{label:"Thông tin website",className:"mb-2",name:"infos",children:e.jsx(n,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Danh sách bài viết",className:"mb-2",name:"pages",children:e.jsx(n,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Danh sách nhóm bài viết",className:"mb-2",name:"grouppages",children:e.jsx(n,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Bố cục (Header - Footer)",className:"mb-2",name:"layouts",children:e.jsx(n,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})})]}):u=="courses"?e.jsxs(e.Fragment,{children:[e.jsx(s.Item,{label:"Danh sách khóa học",className:"mb-2",name:"courses",children:e.jsx(n,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Danh mục khóa học",className:"mb-2",name:"categorycourses",children:e.jsx(n,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})})]}):u=="users"?e.jsxs(e.Fragment,{children:[e.jsx(s.Item,{label:"Danh sách người dùng",className:"mb-2",name:"users",children:e.jsx(n,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Phân quyền",className:"mb-2",name:"roles",children:e.jsx(n,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})})]}):u=="orders"?e.jsxs(e.Fragment,{children:[e.jsx(s.Item,{label:"Key thanh toán",className:"mb-2",name:"keybanks",children:e.jsx(n,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Danh sách đơn hàng",className:"mb-2",name:"orders",children:e.jsx(n,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})})]}):e.jsxs(e.Fragment,{children:[e.jsx(s.Item,{label:"Danh sách plugins",className:"mb-2",name:"plugins",children:e.jsx(n,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Cài đặt",className:"mb-2",name:"settings",children:e.jsx(n,{disabled:!0,showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})})]})})})]})};export{se as default};

import{r as i,d as y,c as M,au as v,av as H,j as m,s as d,D as I,aw as w,e as A}from"./index-DlYMrpPW.js";import{b7 as q}from"./Layout-CpjJMsYa.js";import{P as R,p as $,b as O,a as W,c as G}from"./index-lT8zp5eS.js";import{p as J,B as e}from"./index-h1Dxycz5.js";import{S as E}from"./index-BcZ8U7N5.js";import"./animate-q5OpxXju.js";import"./context-C-Rv8Q9P.js";import"./index-BhRu2L4p.js";import"./index-B0WLfmks.js";import"./index-DJL_NHcj.js";import"./index-DXcoRrUW.js";import"./EllipsisOutlined--Rr4Zdtn.js";import"./Overflow-CkeVNlGt.js";import"./collapse-BbEVqHco.js";import"./button-CE-BZK77.js";import"./compact-item-DVIPdewI.js";import"./index-BA5SGM9y.js";import"./useLocale-AUr8qwmz.js";import"./TextArea-BL_qZjFp.js";import"./index-BYNFFT4D.js";import"./PurePanel-CgvgODcO.js";import"./index-DWBsL6Py.js";import"./SearchOutlined-DFBtPtmd.js";import"./index-RbKsYPWi.js";import"./responsiveObserver--9lCBinC.js";import"./GrapeJs-Chn_j19O.js";import"./fileApi-BlZkL-Jt.js";/* empty css                */import"./row-BjQvrOOl.js";const bt=()=>{var h,f;const[k,L]=i.useState(""),[u,B]=i.useState(!1),g=y(t=>t.pluginsScript.pluginsScript),P=y(t=>t.pluginsScript.loading),C=M(),T=(t,p)=>{const o=new Date,{html:r,css:n,js:s}=p,x=new DOMParser().parseFromString(r,"text/html"),a=x.querySelector("#Header"),l=x.querySelector("#Footer");let S="",b="";const j=r.match(/<body[^>]*>([\s\S]*?)<\/body>/i);if(j&&j[1].trim()===""&&console.log("không có dữ liệu"),!a){d("Chưa có Header!");return}if(!l){d("Chưa có Footer!");return}a&&(S=`<div class="${a.className}">${a.innerHTML}</div>`),l&&(b=`<div id="Footer">${l.innerHTML}</div>`),I(o,"Đang cập nhật..."),v.putLayout(w,{header:S,footer:b,css:n,js:s,edit:t}).then(()=>{A(o,"Cập nhật thành công")}).catch(F=>{d(F.response.data.message)})},D=t=>{t.loadProjectData(k.edit);const p=["video","map","video","bootstrapIcon","map","model-3D","Masonry","quote","link-block","text-basic","text-section","column1","column2","column3","column3-7"],o=["gjs-open-import-webpage","open-templates","link-page","export-template"],r=["Extra","Blog","Layout","Short Codes"],{models:n}=t.BlockManager.getCategories();p.forEach(s=>t.BlockManager.remove(s)),o.forEach(s=>{t.Panels.removeButton("options",s)}),n.forEach(s=>{var c;return r.includes((c=s.get)==null?void 0:c.call(s,"id"))&&s.set("open",!1)})};return i.useEffect(()=>{v.getLayoutEdit().then(t=>{L(t[0]),B(!0)})},[]),i.useEffect(()=>{P===!0&&C(H())},[]),m.jsxs(q,{margin:0,header:"BỐ CỤC WEBSITE",children:[!u&&m.jsx("div",{children:"LOAdding"}),u&&m.jsx(R,{height:"calc(100vh - 56px)",configGrapeJs:D,scripts:(h=g[0])==null?void 0:h.scripts,styles:(f=g[0])==null?void 0:f.styles,pluginss:[{id:"grapesjs-component-icon",src:"http://localhost:8082/plugins/Icon/Indexlayout.js"},{id:"@silexlabs/grapesjs-filter-styles",src:"https://unpkg.com/@silexlabs/grapesjs-filter-styles@1.0.0/dist/index.js"},{id:"grapesjs-parser-postcss",src:"https://unpkg.com/grapesjs-parser-postcss@1.0.3/dist/index.js"}],plugins:[$,O,W,J,G,e.imageLink,e.header,e.footer,e.container,e.user,E.customType,E.customTypeSelect],savePage:T})]})};export{bt as default};

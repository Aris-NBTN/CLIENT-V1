import{r as h,j as e,f as w,U as le,a as ne,c as ie,t as oe,d as q,T as ce,ab as de,Q as me,ai as F,e as he,ac as p,aj as ue,ak as z,al as pe,am as ge,an as xe,ao as je}from"./index-02Ie1n1E.js";import{b7 as be}from"./Layout-bR5O98g-.js";import{E,T as $}from"./Table-BFeYeRWG.js";import{F as P,a as R,c as B,b as ye}from"./jspdf.es.min-Bk9nBU2B.js";import{f as Ce,F as fe,g as Ne,d as U,h as Fe}from"./Format-BNnE4IDY.js";import"./html2canvas.esm-CBrSDip1.js";import{M as ve,a as we}from"./index-CWIHa3Ys.js";import{U as Ie}from"./index-CsTl1dBG.js";import{I as ke}from"./index-DxE7n7tf.js";import{R as Se,T as Te}from"./index-dAcdd_Vh.js";import{T as _,k as Ae,a as n,b as L,l as De}from"./index-DhFToXEO.js";import{F as s}from"./index-DUWYuYEL.js";import{B as v}from"./TextArea-wEabKcRd.js";import{M as V}from"./index-B_W7pc1Q.js";import{I as j}from"./index-CsygCkdV.js";import{S as m}from"./index-BYA2BYF3.js";import{R as G,C as b}from"./row-BSxMqo3Q.js";import"./index-By-1kEmk.js";import"./CheckOutlined-GJNDTYsJ.js";import"./addEventListener-C5IzGLrC.js";import"./iconUtil-_gb3Ws-T.js";import"./EllipsisOutlined-XEv5Jv16.js";import"./Overflow-Vv8o96Db.js";import"./index-BserltQK.js";import"./index-CatiYFEI.js";import"./index-BNpNUA4E.js";import"./SearchOutlined-DoSTaT31.js";import"./index-BJ1qLXci.js";import"./ActionButton-DQoyGuYO.js";import"./index-IdioDR4S.js";import"./progress-NBpEGT-q.js";import"./index-C1BYlxxO.js";const Oe=y=>new Promise((d,u)=>{const o=new FileReader;o.readAsDataURL(y),o.onload=()=>d(o.result),o.onerror=l=>u(l)}),H=({limit:y,apiUpload:d,body:u,fileLists:o,name:l})=>{const[r,I]=h.useState(!1),[k,S]=h.useState(""),g=o==="undefined"?[]:[{uid:o,name:o,status:"done",url:`${w}/uploads/${o}`}],[T,x]=h.useState(g);h.useEffect(()=>{x(g)},[o]);const D=async c=>{!c.url&&!c.preview&&(c.preview=await Oe(c.originFileObj)),S(c.url||c.preview),I(!0)},C=({fileList:c,file:f})=>{x(c),f.status==="done"&&le.put({id:u,[l]:f.response})},t=e.jsxs("button",{style:{border:0,background:"none"},type:"button",children:[e.jsx(Se,{}),e.jsx("div",{style:{marginTop:8},children:"Tải ảnh lên"})]});return e.jsxs(e.Fragment,{children:[e.jsx(Ie,{data:{folder:"123"},action:d,listType:"picture-card",fileList:T,onPreview:D,onChange:C,children:T.length>=y?null:t}),k&&e.jsx(ke,{wrapperStyle:{display:"none"},preview:{visible:r,onVisibleChange:c=>I(c),afterOpenChange:c=>!c&&S("")},src:k})]})},ma=()=>{const y=ne(),d=ie(),[u]=s.useForm(),[o]=s.useForm(),[l]=s.useForm(),{token:{colorPrimary:r}}=oe.useToken(),I=s.useWatch("price",u),k=s.useWatch("sale",u),[S,g]=h.useState(!1),[T,x]=h.useState(!1),[D,C]=h.useState(!1),[t,c]=h.useState(""),{courses:f,loading:A}=q(a=>a.courses),{categoryCourses:i,loading:O}=q(a=>a.categoryCourses),W=h.useMemo(()=>f.map(a=>({...a,key:a._id})),[f]),J=h.useMemo(()=>i.map(a=>({...a,key:a._id})),[i]),K=[{title:"Tên khóa học",dataIndex:"name",width:"10%",type:"text",editable:!0,ellipsis:{showTitle:!0},...P({dataIndex:"name"}),render:a=>e.jsx(ce,{placement:"top",title:a,children:a})},{title:"Link",dataIndex:"slug",width:"10%",type:"text",editable:!1,ellipsis:{showTitle:!0},...P({dataIndex:"slug"}),render:a=>e.jsx(e.Fragment,{children:e.jsx(_.Paragraph,{className:"!mb-0",ellipsis:{suffix:""},copyable:{text:`/course/${a}`},children:a})})},{title:"Danh mục",dataIndex:"category",width:"10%",type:"select",editable:!0,optionSelect:Array.isArray(i)&&i.length>0?i==null?void 0:i.map(a=>({label:a.category,value:a._id})):[],...Array.isArray(i)&&i.length>0?R("category",i.map(a=>({text:a.category,value:a._id}))):{},render:a=>a&&i&&Array.isArray(i)&&i.length>0?Ce(a,i,"category"):null},{title:"Giá",dataIndex:"price",width:"7%",type:"price",editable:!0,...B({dataIndex:"price",type:"number"}),render:a=>fe(a)},{title:"Giảm",dataIndex:"sale",width:"5%",type:"percent",editable:!0,...B({dataIndex:"sale",type:"number"}),render:a=>Ne(a)},{title:"Trang thái",dataIndex:"status",width:"8%",type:"select",optionSelect:[{label:"Đang bán",value:"Đang bán"},{label:"Chưa bán",value:"Chưa bán"}],editable:!0,...R("status",[{value:"Đang bán",text:"Đang bán"},{value:"Chưa bán",text:"Chưa bán"}])},{title:"Sao",dataIndex:"star",width:"6%",type:"select",optionSelect:[{label:"3",value:"3"},{label:"4",value:"4"},{label:"4.5",value:"4.5"},{label:"5",value:"5"}],editable:!0},{title:"Ngày tạo",dataIndex:"createdAt",width:"8%",...ye({dataIndex:"createdAt"}),render:a=>U(a)},{title:"Cập nhập",dataIndex:"updatedAt",width:"8%",render:a=>Fe(a)},{title:"Thông tin",dataIndex:"info",width:"7%",render:(a,N)=>e.jsx("div",{className:"flex justify-center",children:e.jsx(v,{type:"primary",ghost:!0,onClick:()=>{l.setFieldsValue(N),g(!0),c(N)},children:"Thông tin"})})}],Q=[{title:"Tên danh mục",dataIndex:"category",width:"70%",type:"text",editable:!0,...P({dataIndex:"category"})}],X=a=>{p(d,ue(a),()=>{x(!1),u.resetFields()})},Y=a=>{p(d,z(a))},Z=a=>{a.id=a.key,p(d,z(a),()=>{g(!1),l.resetFields()})},ee=a=>{p(d,pe(a))},ae=a=>{p(d,ge(a),()=>{C(!1),o.resetFields()})},te=a=>{p(d,xe(a))},se=a=>{p(d,je(a))};return h.useEffect(()=>{A===!0&&d(de())},[]),h.useEffect(()=>{O&&d(me())},[]),h.useEffect(()=>{(()=>{const N=u.getFieldValue("price")||0,re=u.getFieldValue("sale")||0,M=N-N*re/100;u.setFieldsValue({priceSale:M>=0?M:0})})()},[I,k]),e.jsxs(be,{header:e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex items-center",children:e.jsx("h6",{className:"mb-0",children:"KHÓA HỌC"})})}),button:e.jsxs(e.Fragment,{children:[e.jsx(v,{type:"primary",onClick:()=>{C(!0)},children:" Thêm danh mục"}),e.jsx(v,{type:"primary",onClick:()=>x(!0),children:"Thêm khóa học"})]}),children:[e.jsx(E,{loading:A,data:W,columns:K,onSave:Y,onDelete:ee,button:a=>e.jsx("div",{className:"flex gap-3",children:e.jsx(ve,{onClick:()=>y(`/admin/course/${a.slug}`),size:20,color:"red"})})}),e.jsx(V,{title:e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[" Thông tin khóa học: ",e.jsx(_.Text,{type:"danger",children:l.getFieldValue("name")})]}),e.jsx(v,{className:"me-4",icon:t!=null&&t.seo?e.jsx(Ae,{size:20,color:r}):e.jsx(we,{size:20,color:"red"}),onClick:()=>{const a={"@context":"https://schema.org/","@id":t==null?void 0:t.slug,"@type":"Course",name:t==null?void 0:t.name,description:t==null?void 0:t.description,publisher:{"@type":"Organization",name:"Chicken War Studio",url:`${F}`},provider:{"@type":"Organization",name:"Chicken War Studio",url:`${F}`},image:[`${w}/upload/course/123/${t==null?void 0:t.imgDetail}`,`${w}/upload/course/123/${t==null?void 0:t.img}`],aggregateRating:{"@type":"AggregateRating",ratingValue:t==null?void 0:t.star,ratingCount:2e3,reviewCount:1200},offers:[{"@type":"Offer",category:t==null?void 0:t.category,priceCurrency:"VND",price:t==null?void 0:t.price}],hasCourseInstance:[{"@type":"CourseInstance",courseMode:"Blended",location:"HoChiMinh University",courseSchedule:{"@type":"Schedule",duration:"PT3H",repeatFrequency:"Daily",repeatCount:31},instructor:[{"@type":"Person",name:"Nguyen Bac Trung Nam",description:"3D Artist",image:`${F}`}]},{"@type":"CourseInstance",courseMode:"Online",courseWorkload:"3D"}],totalHistoricalEnrollment:400,datePublished:U(t==null?void 0:t.createdAt),educationalLevel:"Advanced",about:["3D Modeling","3D environment","3D artist"],teaches:["Practice and apply systems thinking to plan for change","Understand how memory allocation works."],financialAidEligible:"Scholarship Available",inLanguage:"vn",availableLanguage:["vn","es"],coursePrerequisites:["Basic understanding of C++ up to arrays and functions.",`${F}`],educationalCredentialAwarded:[{"@type":"EducationalOccupationalCredential",name:"3D Modeling Certificate",url:`${F}`,credentialCategory:"Certificate"}]};he("ldjs","Tạo file thành công","Đã tạo file LD+JS, vui lòng cập nhập!"),l.setFieldValue("seo",a)},children:t!=null&&t.seo?"Đã tạo file LD+JS":"Tạo file LD+JS"})]})}),centered:!0,open:S,maskClosable:!1,onOk:()=>l.submit(),onCancel:()=>{g(!1),l.resetFields()},confirmLoading:A,width:800,children:e.jsxs(s,{form:l,name:"customForm",layout:"vertical",onFinish:Z,children:[e.jsx(s.Item,{className:"mb-0 hidden",name:"key",children:e.jsx(j,{className:"mb-2"})}),e.jsx(s.Item,{className:"mb-2",name:"title",label:"Tiêu đề",children:e.jsx(j,{size:"large",className:"mb-2",placeholder:"Nhập tiêu đề"})}),e.jsx(s.Item,{className:"mb-2",name:"prerequisite",label:"Điều kiện tiên quyết",children:e.jsx(m,{size:"large",className:"w-full mb-2",placeholder:"Chọn & nhập điều kiện tiên quyết",mode:"tags",tokenSeparators:[","]})}),e.jsx(s.Item,{className:"mb-2",name:"customer",label:"Đối tượng khách hàng",children:e.jsx(m,{size:"large",className:"w-full mb-2",placeholder:"Chọn & nhập đối tượng khách hàng",mode:"tags",tokenSeparators:[","]})}),e.jsx(s.Item,{className:"mb-2",name:"output",label:"Tiêu chí đầu ra",children:e.jsx(m,{size:"large",className:"w-full mb-2",placeholder:"Chọn & nhập tiêu chí đầu ra",mode:"tags",tokenSeparators:[","]})}),e.jsx(s.Item,{className:"mb-2",name:"benefit",label:"Lợi ích từ khóa học",children:e.jsx(m,{size:"large",className:"w-full mb-2",placeholder:"Chọn & nhập lợi ích",mode:"tags",tokenSeparators:[","]})}),e.jsx(s.Item,{className:"mb-0 hidden",name:"seo",children:e.jsx(j,{className:"mb-2"})}),e.jsxs("div",{className:"flex flex-wrap md:flex-nowrap mt-2 gap-2 justify-center",children:[e.jsx(s.Item,{className:"mb-2",label:"Ảnh bìa",children:e.jsx(H,{apiUpload:`${w}/v1/courser/image`,name:"img",body:l==null?void 0:l.getFieldValue("_id"),fileLists:`${l==null?void 0:l.getFieldValue("img")}`,limit:1})}),e.jsx(s.Item,{className:"mb-2",label:"Ảnh chi tiết",children:e.jsx(H,{apiUpload:`${w}/v1/courser/image`,name:"imgDetail",body:l.getFieldValue("_id"),fileLists:`${l.getFieldValue("imgDetail")}`,limit:1})}),e.jsx(s.Item,{className:"w-full mb-2",name:"description",label:" Mô tả",children:e.jsx(j.TextArea,{size:"large",className:"mb-2",placeholder:"Nhập mô tả",style:{height:100,resize:"none"}})})]})]})}),e.jsx(V,{title:"Khóa học",centered:!0,open:T,onOk:()=>u.submit(),onCancel:()=>x(!1),confirmLoading:A,width:600,children:e.jsxs(s,{form:u,name:"customForm",layout:"vertical",onFinish:X,children:[e.jsx(s.Item,{className:"mb-2",name:"name",label:"Tên khóa học",rules:[{required:!0,message:"Nhập tên khóa học!"}],children:e.jsx(j,{placeholder:"Nhập tên khóa học"})}),e.jsxs(G,{gutter:[14,14],children:[e.jsx(b,{span:8,children:e.jsx(s.Item,{className:"mb-2",name:"category",label:"Danh mục",rules:[{required:!0,message:"Chọn danh mục!"}],children:e.jsx(m,{options:i.map(a=>({label:a.category,value:a._id})),placeholder:"Chọn danh mục"})})}),e.jsx(b,{span:8,children:e.jsx(s.Item,{className:"mb-2",name:"status",label:"Trạng thái",rules:[{required:!0,message:"Chọn trạng thái!"}],children:e.jsxs(m,{placeholder:"Chọn trạng thái",children:[e.jsx(m.Option,{value:"Đang bán",children:"Đang bán"}),e.jsx(m.Option,{value:"Chưa bán",children:"Chưa bán"})]})})}),e.jsx(b,{span:8,children:e.jsx(s.Item,{className:"mb-2",name:"star",label:"Số sao",rules:[{required:!0,message:"Chọn số sao!"}],children:e.jsxs(m,{placeholder:"Chọn trạng thái",children:[e.jsx(m.Option,{value:"3",children:e.jsxs("div",{className:"flex",children:[e.jsx(n,{color:r}),e.jsx(n,{color:r}),e.jsx(n,{color:r}),e.jsx(L,{color:r}),e.jsx(L,{color:r})]})}),e.jsx(m.Option,{value:"4",children:e.jsxs("div",{className:"flex",children:[e.jsx(n,{color:r}),e.jsx(n,{color:r}),e.jsx(n,{color:r}),e.jsx(n,{color:r}),e.jsx(L,{color:r})]})}),e.jsx(m.Option,{value:"4.5",children:e.jsxs("div",{className:"flex",children:[e.jsx(n,{color:r}),e.jsx(n,{color:r}),e.jsx(n,{color:r}),e.jsx(n,{color:r}),e.jsx(De,{color:r})]})}),e.jsx(m.Option,{value:"5",children:e.jsxs("div",{className:"flex",children:[e.jsx(n,{color:r}),e.jsx(n,{color:r}),e.jsx(n,{color:r}),e.jsx(n,{color:r}),e.jsx(n,{color:r})]})})]})})})]}),e.jsxs(G,{gutter:[14,14],children:[e.jsx(b,{span:8,children:e.jsx(s.Item,{className:"mb-0",name:"price",label:"Giá tiền VN",rules:[{required:!0,message:"Nhập giá tiền!"}],children:e.jsx($,{className:"w-full mb-2",placeholder:"Nhập giá tiền",min:0,step:1e5,parser:a=>a==null?void 0:a.replace(/\$\s?|(,*)/g,""),formatter:a=>`${a}`.replace(/\B(?=(\d{3})+(?!\d))/g,",")})})}),e.jsx(b,{span:8,children:e.jsx(s.Item,{className:"mb-0",name:"sale",label:"Giảm giá %",rules:[{required:!0,message:"Nhập %!"}],children:e.jsx($,{className:"w-full mb-2",placeholder:"Nhập %",min:0,max:100,step:5})})}),e.jsx(b,{span:8,children:e.jsx(s.Item,{className:"mb-0",label:"Giá sau khi giảm",name:"priceSale",children:e.jsx($,{className:"w-full mb-2",placeholder:"Giá sau khi giảm",readOnly:!0,min:0,step:1e5,parser:a=>a==null?void 0:a.replace(/\$\s?|(,*)/g,""),formatter:a=>`${a}`.replace(/\B(?=(\d{3})+(?!\d))/g,",")})})})]})]})}),e.jsx(V,{centered:!0,open:D,onCancel:()=>C(!1),footer:null,width:600,children:e.jsx(Te,{centered:!0,items:[{label:"Thêm danh mục",key:"1",children:e.jsx(e.Fragment,{children:e.jsxs(s,{form:o,name:"customForm",layout:"vertical",onFinish:ae,children:[e.jsx(s.Item,{className:"mb-3",name:"category",label:"Tên danh mục",rules:[{required:!0,message:"Nhập tên danh mục!"}],children:e.jsx(j,{placeholder:"Nhập tên danh mục"})}),e.jsx(v,{type:"primary",loading:O,onClick:()=>o.submit(),className:"flex float-end",children:"Thêm danh mục"})]})})},{label:"Chỉnh sửa danh mục",key:"2",children:e.jsx(e.Fragment,{children:e.jsx(E,{loading:O,data:J,columns:Q,onSave:te,onDelete:se,width:"20%",scroll:{x:500,y:350}})})}]})})]})};export{ma as default};

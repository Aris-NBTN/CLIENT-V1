import{q,s as I,r as n,j as e,bb as T,bc as V,bd as $,T as c,ab as X,aj as s,be as Q,I as R,bf as H,bg as J,bh as K,bi as U,bj as W,bk as Y}from"./index-6AfYbl-K.js";import{bb as Z,b7 as ee}from"./Layout-DARDxYOA.js";import{E as k}from"./Table-BnA8Yodx.js";import{F as d,a as te}from"./Filter-CCcBGbkM.js";import{e as ae,f as re}from"./Format-BqqHNfKh.js";import{v as ie,w as ne,x as w}from"./index-7JilEvWs.js";import{e as se}from"./export-CMY-gC2Z.js";import{F as l}from"./index-BPFm254i.js";import{T as h}from"./index-BcwvvWET.js";import{B as o}from"./button-Czt-CxNq.js";import{M as C}from"./index-Bm2zEGaQ.js";import{I as S}from"./index-Dt5upN5P.js";import{T as le}from"./index-BedhajwX.js";import"./index-CecO4LnH.js";import"./index-C3nRum2W.js";import"./index-BDqapfMa.js";import"./row-Bgy8XCwY.js";import"./index-v3e6hEig.js";import"./Overflow-CTLObAd3.js";import"./PurePanel-DFgSlsd-.js";import"./useVariants-B8E7oZP8.js";import"./index-CsVqu72X.js";import"./useLocale-B5IigTwq.js";import"./compact-item-CRXRFQ0U.js";import"./CheckOutlined-dq0Gckb5.js";import"./SearchOutlined-CNqk3EOE.js";import"./context-BpHl7iEz.js";import"./EllipsisOutlined-CLWcPuTv.js";import"./Dropdown-Dk-edO6X.js";import"./index-B6e-1niT.js";import"./iconUtil-CkaJIA9z.js";import"./index-DjG62uoh.js";import"./TextArea-D899ar1i.js";import"./index-DhPUPvxi.js";import"./index-s1_5RoPl.js";import"./index-D6HwV4R_.js";import"./html2canvas.esm-CBrSDip1.js";import"./jspdf.es.min-Dz5k1d_j.js";const Re=()=>{const r=q(),N=Z({query:"(max-width: 576px)"}),[u]=l.useForm(),[m]=l.useForm(),{pages:i,loading:x}=I(t=>t.pages),{groupPages:g,loading:p}=I(t=>t.groupPages),a=g==null?void 0:g.newData,[D,f]=n.useState(!1),[E,b]=n.useState(!1),[j,y]=n.useState(localStorage.getItem("drag")==="true"),A=n.useMemo(()=>{var t;return(t=i==null?void 0:i.newData)==null?void 0:t.map(F=>({...F,key:F._id}))},[i]),v=n.useMemo(()=>a==null?void 0:a.map(t=>({...t,key:t._id})),[a]),G=[{title:"Tên trang",dataIndex:"name",width:"15%",editable:!0,ellipsis:{showTitle:!0},...d({dataIndex:"name"})},{title:"Link Trang",dataIndex:"slug",width:"15%",editable:!1,ellipsis:{showTitle:!0},...d({dataIndex:"slug"}),render:t=>e.jsx(e.Fragment,{children:e.jsx(h.Paragraph,{className:"!mb-0",ellipsis:{suffix:""},copyable:{text:`/${t}`},children:t})})},{title:"Tiêu đề trang",dataIndex:"title",width:"15%",editable:!0,...d({dataIndex:"title"})},{title:"Mô tả",dataIndex:"description",width:"15%",editable:!0,...d({dataIndex:"description"})},{title:"Từ khóa",dataIndex:"keywords",width:"15%",type:"tag",editable:!0,render:t=>e.jsx(ae,{keywords:t})},{title:"Nhóm",dataIndex:"group",width:"8%",type:"select",editable:!0,optionSelect:Array.isArray(a)&&(a==null?void 0:a.length)>0?a==null?void 0:a.map(t=>({label:t.group,value:t._id})):[],render:t=>t&&a&&Array.isArray(a)&&(a==null?void 0:a.length)>0?re(t,a,"group"):null,...Array.isArray(a)&&(a==null?void 0:a.length)>0?te("group",a==null?void 0:a.map(t=>({text:t.group,value:t._id}))):{}}],P=[{title:"Tên nhóm",dataIndex:"group",width:"60%",type:"text",editable:!0,...d({dataIndex:"group"})}],M=t=>{s(r,H(t),()=>{f(!1),u.resetFields()})},B=t=>{s(r,J(t))},L=t=>{s(r,K(t))},_=t=>{s(r,U(t),()=>{b(!1),m.resetFields()})},z=t=>{s(r,W(t))},O=t=>{s(r,Y(t))};return n.useEffect(()=>{x&&r(T({page:1,limit:localStorage.getItem("pageSize")||10}))},[]),n.useEffect(()=>{p===!0&&r(V())},[]),e.jsxs(ee,{title:"Bài viết",header:"BÀI VIẾT",button:e.jsxs(e.Fragment,{children:[j?e.jsx(o,{onClick:()=>{y(!1),localStorage.setItem("drag","false")},children:e.jsx(h,{children:"Tắt sắp xếp"})}):e.jsx(o,{type:"primary",onClick:()=>{y(!0),localStorage.setItem("drag","true")},children:"Bật sắp xếp"}),e.jsx(o,{type:"primary",onClick:()=>b(!0),children:"Thêm nhóm"}),e.jsx(o,{type:"primary",onClick:()=>f(!0),children:"Thêm trang"}),e.jsx(o,{onClick:()=>se(A,"Pages.xlsx"),type:"primary",children:"Xuất file Excel"})]}),children:[e.jsx(k,{dragMode:j,Api:T,ApiPut:$,total:i==null?void 0:i.totalItems,loading:x,data:A,columns:G,onSave:B,onDelete:L,width:"12%",button:t=>e.jsxs(e.Fragment,{children:[e.jsx(c,{title:"Xem trang",children:e.jsx(X,{to:t.slug==="trang-chu"?"/":`/${t.slug}`,target:"_blank",children:e.jsx(ie,{size:22,color:"#006aff"})})}),e.jsx(c,{title:"Sao chép trang",children:e.jsx(h,{onClick:()=>s(r,Q(t._id)),children:e.jsx(ne,{size:22,color:"#55ff00"})})}),N?e.jsx(e.Fragment,{children:e.jsx(c,{title:"Chỉnh sửa trang",children:e.jsx(h.Link,{onClick:()=>R("","Bạn không thể truy cập trang này!","Vui lòng sử dụng máy tính để trãi nghiệm tốt nhất!"),children:e.jsx(w,{size:22,color:"rgb(255 127 0)"})})})}):e.jsx(c,{title:"Chỉnh sửa trang",children:e.jsx("a",{href:`/admin/page/${t.slug}`,children:e.jsx(w,{size:22,color:"rgb(255 127 0)"})})})]})}),e.jsx(C,{title:"Thêm trang",centered:!0,open:D,onOk:()=>u.submit(),onCancel:()=>f(!1),confirmLoading:x,width:500,children:e.jsx(l,{form:u,name:"customForm",layout:"vertical",onFinish:M,children:e.jsx(l.Item,{label:"Tên trang",className:"mb-2",name:"name",rules:[{required:!0,message:"Vui lòng nhập tên trang!"}],children:e.jsx(S,{className:"mb-2",placeholder:"Nhập tên trang"})})})}),e.jsx(C,{centered:!0,open:E,confirmLoading:p,onOk:()=>m.submit(),onCancel:()=>b(!1),footer:null,width:600,children:e.jsx(le,{centered:!0,items:[{label:"Thêm nhóm",key:"1",children:e.jsx(e.Fragment,{children:e.jsxs(l,{form:m,name:"customForm",layout:"vertical",onFinish:_,children:[e.jsx(l.Item,{className:"mb-3",name:"group",label:"Tên nhóm",rules:[{required:!0,message:"Nhập tên nhóm!"}],children:e.jsx(S,{placeholder:"Nhập nhóm"})}),e.jsx(o,{type:"primary",loading:p,onClick:()=>m.submit(),className:"flex float-end",children:"Thêm nhóm"})]})})},{label:"Chỉnh sửa nhóm",key:"2",children:e.jsx(e.Fragment,{children:e.jsx(k,{loading:p,data:v,isScroll:!1,columns:P,width:"10%",onSave:z,onDelete:O})})}]})})]})};export{Re as default};

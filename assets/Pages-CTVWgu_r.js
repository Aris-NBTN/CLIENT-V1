import{c as O,aZ as $,d as F,r as n,j as e,a6 as T,a_ as q,a$ as V,T as h,N as X,ac as l,b0 as Q,W as R,b1 as W,b2 as Z,b3 as H,b4 as J,b5 as K,b6 as U}from"./index-D_8e4c1c.js";import{b7 as Y}from"./Layout-CyzyjsxQ.js";import{E as I}from"./Table-BscFkU2Z.js";import{F as m,a as ee}from"./jspdf.es.min-DtfdLfp_.js";import{e as te,f as ae}from"./Format-D701Ge6d.js";import{T as s,m as re,n as se,o as k}from"./index-Dmxhq2rE.js";import{e as ie}from"./export-ROJ2lOPZ.js";import{F as o}from"./index-BK034_kP.js";import{B as d}from"./TextArea-CWw6Kbja.js";import{M as C}from"./index-BkKl_ZBW.js";import{I as P}from"./index-BkckKk1m.js";import{T as ne}from"./index-CGW289Qd.js";import"./index-D2w-eL_m.js";import"./index-DUMoXffW.js";import"./EllipsisOutlined-DotS4OyN.js";import"./Overflow-D7J6rgzg.js";import"./CheckOutlined-DdAy9wLR.js";import"./index-BMT87hfN.js";import"./index-Bk93MzKf.js";import"./index-Coxcvceq.js";import"./SearchOutlined-CK_rNMR1.js";import"./context-CZuqpdQ0.js";import"./sortable.esm-WutAO-q0.js";import"./addEventListener-CB8yRRsv.js";import"./iconUtil-CFlHBpPL.js";import"./index-BtrI-hsZ.js";import"./index-Dm38w3Iq.js";import"./index-F-ZYeqsl.js";import"./ActionButton-BdPhl_ld.js";import"./html2canvas.esm-CBrSDip1.js";import"./row-9dsEpJck.js";import"./index-uxb3IG00.js";const ze=()=>{const r=O(),w=$({query:"(max-width: 576px)"}),[u]=o.useForm(),[p]=o.useForm(),{pages:i,loading:g}=F(t=>t.pages),{groupPages:a,loading:c}=F(t=>t.groupPages),[S,x]=n.useState(!1),[N,f]=n.useState(!1),[j,y]=n.useState(localStorage.getItem("drag")==="true"),b=n.useMemo(()=>{var t;return(t=i==null?void 0:i.newData)==null?void 0:t.map(A=>({...A,key:A._id}))},[i]),E=n.useMemo(()=>a.map(t=>({...t,key:t._id})),[a]),D=[{title:"Tên trang",dataIndex:"name",width:"15%",editable:!0,ellipsis:{showTitle:!0},...m({dataIndex:"name"})},{title:"Link Trang",dataIndex:"slug",width:"15%",editable:!1,ellipsis:{showTitle:!0},...m({dataIndex:"slug"}),render:t=>e.jsx(e.Fragment,{children:e.jsx(s.Paragraph,{className:"!mb-0",ellipsis:{suffix:""},copyable:{text:`/${t}`},children:t})})},{title:"Tiêu đề trang",dataIndex:"title",width:"15%",editable:!0,...m({dataIndex:"title"})},{title:"Mô tả",dataIndex:"description",width:"15%",editable:!0,...m({dataIndex:"description"})},{title:"Từ khóa",dataIndex:"keywords",width:"15%",type:"tag",editable:!0,render:t=>e.jsx(te,{keywords:t})},{title:"Nhóm",dataIndex:"group",width:"8%",type:"select",editable:!0,optionSelect:Array.isArray(a)&&a.length>0?a==null?void 0:a.map(t=>({label:t.group,value:t._id})):[],render:t=>t&&a&&Array.isArray(a)&&a.length>0?ae(t,a,"group"):null,...Array.isArray(a)&&a.length>0?ee("group",a.map(t=>({text:t.group,value:t._id}))):{}}],G=[{title:"Tên nhóm",dataIndex:"group",width:"60%",type:"text",editable:!0,...m({dataIndex:"group"})}],M=t=>{l(r,W(t),()=>{x(!1),u.resetFields()})},v=t=>{l(r,Z(t))},_=t=>{l(r,H(t))},B=t=>{l(r,J(t),()=>{f(!1),p.resetFields()})},L=t=>{l(r,K(t))},z=t=>{l(r,U(t))};return n.useEffect(()=>{g&&r(T({page:1,limit:localStorage.getItem("pageSize")||10}))},[]),n.useEffect(()=>{c===!0&&r(q())},[]),e.jsxs(Y,{header:"BÀI VIẾT",button:e.jsxs(e.Fragment,{children:[j?e.jsx(d,{onClick:()=>{y(!1),localStorage.setItem("drag","false")},children:e.jsx(s,{children:"Tắt sắp xếp"})}):e.jsx(d,{type:"primary",onClick:()=>{y(!0),localStorage.setItem("drag","true")},children:e.jsx(s,{children:"Bật sắp xếp "})}),e.jsx(d,{type:"primary",onClick:()=>f(!0),children:e.jsx(s,{children:"Thêm nhóm"})}),e.jsx(d,{type:"primary",onClick:()=>x(!0),children:e.jsx(s,{children:"Thêm trang"})}),e.jsx(d,{onClick:()=>ie(b,"Pages.xlsx"),type:"primary",children:e.jsx(s,{children:"Xuất file Excel"})})]}),children:[e.jsx(I,{dragMode:j,Api:T,ApiPut:V,total:i==null?void 0:i.totalItems,loading:g,data:b,columns:D,onSave:v,onDelete:_,width:"12%",button:t=>e.jsxs(e.Fragment,{children:[e.jsx(h,{title:"Xem trang",children:e.jsx(X,{to:t.slug==="trang-chu"?"/":`/${t.slug}`,target:"_blank",children:e.jsx(re,{size:22,color:"#006aff"})})}),e.jsx(h,{title:"Sao chép trang",children:e.jsx(s,{onClick:()=>l(r,Q(t._id)),children:e.jsx(se,{size:22,color:"#55ff00"})})}),w?e.jsx(e.Fragment,{children:e.jsx(h,{title:"Chỉnh sửa trang",children:e.jsx(s.Link,{onClick:()=>R("","Bạn không thể truy cập trang này!","Vui lòng sử dụng máy tính để trãi nghiệm tốt nhất!"),children:e.jsx(k,{size:22,color:"rgb(255 127 0)"})})})}):e.jsx(h,{title:"Chỉnh sửa trang",children:e.jsx("a",{href:`/admin/page/${t.slug}`,children:e.jsx(k,{size:22,color:"rgb(255 127 0)"})})})]})}),e.jsx(C,{title:"Thêm trang",centered:!0,open:S,onOk:()=>u.submit(),onCancel:()=>x(!1),confirmLoading:g,width:500,children:e.jsx(o,{form:u,name:"customForm",layout:"vertical",onFinish:M,children:e.jsx(o.Item,{label:"Tên trang",className:"mb-2",name:"name",rules:[{required:!0,message:"Vui lòng nhập tên trang!"}],children:e.jsx(P,{className:"mb-2",placeholder:"Nhập tên trang"})})})}),e.jsx(C,{centered:!0,open:N,confirmLoading:c,onOk:()=>p.submit(),onCancel:()=>f(!1),footer:null,width:600,children:e.jsx(ne,{centered:!0,items:[{label:"Thêm nhóm",key:"1",children:e.jsx(e.Fragment,{children:e.jsxs(o,{form:p,name:"customForm",layout:"vertical",onFinish:B,children:[e.jsx(o.Item,{className:"mb-3",name:"group",label:"Tên nhóm",rules:[{required:!0,message:"Nhập tên nhóm!"}],children:e.jsx(P,{placeholder:"Nhập nhóm"})}),e.jsx(d,{type:"primary",loading:c,onClick:()=>p.submit(),className:"flex float-end",children:"Thêm nhóm"})]})})},{label:"Chỉnh sửa nhóm",key:"2",children:e.jsx(e.Fragment,{children:e.jsx(I,{loading:c,data:E,isScroll:!1,columns:G,width:"10%",onSave:L,onDelete:z})})}]})})]})};export{ze as default};

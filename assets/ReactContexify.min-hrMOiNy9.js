import{r as v,w as B,R as p}from"./index-C6ierBjl.js";function W(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=W(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function A(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=W(t))&&(r&&(r+=" "),r+=e);return r}var H=v.createContext({}),Y=()=>v.useContext(H),j=t=>p.createElement(H.Provider,{...t});function q(){let t=new Map;return{on(e,n){return t.has(e)?t.get(e).add(n):t.set(e,new Set([n])),this},off(e,n){return t.has(e)&&t.get(e).delete(n),this},emit(e,n){return t.has(e)&&t.get(e).forEach(r=>{r(n)}),this}}}var P=q(),z=()=>v.useRef(new Map).current,Q=()=>{},I=["resize","contextmenu","click","scroll","blur"],O={show({event:t,id:e,props:n,position:r}){t.preventDefault&&t.preventDefault(),P.emit(0).emit(e,{event:t.nativeEvent||t,props:n,position:r})},hideAll(){P.emit(0)}};function oe(t){return{show(e){O.show({...t,...e})},hideAll(){O.hideAll()}}}function Z(){let t=new Map,e,n,r,l,s=!1;function L(i){l=Array.from(i.values()),e=-1,r=!0}function y(){l[e].node.focus()}let h=()=>e>=0&&l[e].isSubmenu,T=()=>Array.from(l[e].submenuRefTracker.values());function c(){return e===-1?(b(),!1):!0}function b(){e+1<l.length?e++:e+1===l.length&&(e=0),s&&a(),y()}function E(){e===-1||e===0?e=l.length-1:e-1<l.length&&e--,s&&a(),y()}function w(){if(c()&&h()){let i=T(),{node:u,setSubmenuPosition:x}=l[e];return t.set(u,{isRoot:r,focusedIndex:e,parentNode:n||u,items:l}),x(),u.classList.add("contexify_submenu-isOpen"),n=u,i.length>0?(e=0,l=i):s=!0,r=!1,y(),!0}return!1}function a(){if(c()&&!r){let i=t.get(n);n.classList.remove("contexify_submenu-isOpen"),l=i.items,n=i.parentNode,i.isRoot&&(r=!0,t.clear()),s||(e=i.focusedIndex,y())}}function _(i){function u(x){for(let o of x)o.isSubmenu&&o.submenuRefTracker&&u(Array.from(o.submenuRefTracker.values())),o.keyMatcher&&o.keyMatcher(i)}u(l)}return{init:L,moveDown:b,moveUp:E,openSubmenu:w,closeSubmenu:a,matchKeys:_}}function N(t){return typeof t=="function"}function U(t){return typeof t=="string"}function V(t,e){return v.Children.map(v.Children.toArray(t).filter(Boolean),n=>v.cloneElement(n,e))}function ee(t){let e={x:t.clientX,y:t.clientY},n=t.changedTouches;return n&&(e.x=n[0].clientX,e.y=n[0].clientY),(!e.x||e.x<0)&&(e.x=0),(!e.y||e.y<0)&&(e.y=0),e}function D(t,e){return N(t)?t(e):t}function te(t,e){return{...t,...N(e)?e(t):e}}var se=({id:t,theme:e,style:n,className:r,children:l,animation:s="fade",preventDefaultOnKeydown:L=!0,disableBoundariesCheck:y=!1,onVisibilityChange:h,...T})=>{let[c,b]=v.useReducer(te,{x:0,y:0,visible:!1,triggerEvent:{},propsFromTrigger:null,willLeave:!1}),E=v.useRef(null),w=z(),[a]=v.useState(()=>Z()),_=v.useRef(),i=v.useRef();v.useEffect(()=>(P.on(t,x).on(0,o),()=>{P.off(t,x).off(0,o)}),[t,s,y]),v.useEffect(()=>{c.visible?a.init(w):w.clear()},[c.visible,a,w]);function u(m,g){if(E.current&&!y){let{innerWidth:d,innerHeight:C}=window,{offsetWidth:M,offsetHeight:K}=E.current;m+M>d&&(m-=m+M-d),g+K>C&&(g-=g+K-C)}return{x:m,y:g}}v.useEffect(()=>{c.visible&&b(u(c.x,c.y))},[c.visible]),v.useEffect(()=>{function m(d){L&&d.preventDefault()}function g(d){switch(d.key){case"Enter":case" ":a.openSubmenu()||o();break;case"Escape":o();break;case"ArrowUp":m(d),a.moveUp();break;case"ArrowDown":m(d),a.moveDown();break;case"ArrowRight":m(d),a.openSubmenu();break;case"ArrowLeft":m(d),a.closeSubmenu();break;default:a.matchKeys(d);break}}if(c.visible){window.addEventListener("keydown",g);for(let d of I)window.addEventListener(d,o)}return()=>{window.removeEventListener("keydown",g);for(let d of I)window.removeEventListener(d,o)}},[c.visible,a,L]);function x({event:m,props:g,position:d}){m.stopPropagation();let C=d||ee(m),{x:M,y:K}=u(C.x,C.y);B.flushSync(()=>{b({visible:!0,willLeave:!1,x:M,y:K,triggerEvent:m,propsFromTrigger:g})}),clearTimeout(i.current),!_.current&&N(h)&&(h(!0),_.current=!0)}function o(m){m!=null&&(m.button===2||m.ctrlKey)&&m.type!=="contextmenu"||(s&&(U(s)||"exit"in s&&s.exit)?b(g=>({willLeave:g.visible})):b(g=>({visible:g.visible?!1:g.visible})),i.current=setTimeout(()=>{N(h)&&h(!1),_.current=!1}))}function S(){c.willLeave&&c.visible&&B.flushSync(()=>b({visible:!1,willLeave:!1}))}function $(){return U(s)?A({[`contexify_willEnter-${s}`]:k&&!F,[`contexify_willLeave-${s} contexify_willLeave-'disabled'`]:k&&F}):s&&"enter"in s&&"exit"in s?A({[`contexify_willEnter-${s.enter}`]:s.enter&&k&&!F,[`contexify_willLeave-${s.exit} contexify_willLeave-'disabled'`]:s.exit&&k&&F}):null}let{visible:k,triggerEvent:f,propsFromTrigger:R,x:X,y:G,willLeave:F}=c,J=A("contexify",r,{[`contexify_theme-${e}`]:e},$());return p.createElement(j,{value:w},k&&p.createElement("div",{...T,className:J,onAnimationEnd:S,style:{...n,left:X,top:G,opacity:1},ref:E,role:"menu"},V(l,{propsFromTrigger:R,triggerEvent:f})))},ae=({id:t,children:e,className:n,style:r,triggerEvent:l,data:s,propsFromTrigger:L,keyMatcher:y,onClick:h=Q,disabled:T=!1,hidden:c=!1,closeOnClick:b=!0,handlerEvent:E="onClick",...w})=>{let a=v.useRef(),_=Y(),i={id:t,data:s,triggerEvent:l,props:L},u=D(T,i),x=D(c,i);function o(f){i.event=f,f.stopPropagation(),u||(b?S():h(i))}function S(){let f=a.current;f.focus(),f.addEventListener("animationend",()=>setTimeout(O.hideAll),{once:!0}),f.classList.add("contexify_item-feedback"),h(i)}function $(f){f&&!u&&(a.current=f,_.set(f,{node:f,isSubmenu:!1,keyMatcher:!u&&N(y)&&(R=>{y(R)&&(R.stopPropagation(),R.preventDefault(),i.event=R,S())})}))}function k(f){(f.key==="Enter"||f.key===" ")&&(f.stopPropagation(),i.event=f,S())}return x?null:p.createElement("div",{...w,[E]:o,className:A("contexify_item",n,{"contexify_item-disabled":u}),style:r,onKeyDown:k,ref:$,tabIndex:-1,role:"menuitem","aria-disabled":u},p.createElement("div",{className:"contexify_itemContent"},e))},le=({triggerEvent:t,data:e,propsFromTrigger:n,hidden:r=!1})=>D(r,{data:e,triggerEvent:t,props:n})?null:p.createElement("div",{className:"contexify_separator"}),ne=()=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},p.createElement("polyline",{points:"9 18 15 12 9 6"})),re=({className:t,...e})=>p.createElement("div",{className:A("contexify_rightSlot",t),...e}),ce=({arrow:t,children:e,disabled:n=!1,hidden:r=!1,label:l,className:s,triggerEvent:L,propsFromTrigger:y,style:h,...T})=>{let c=Y(),b=z(),E=v.useRef(null),w={triggerEvent:L,props:y},a=D(n,w),_=D(r,w);function i(){let o=E.current;if(o){let S="contexify_submenu-bottom",$="contexify_submenu-right";o.classList.remove(S,$);let k=o.getBoundingClientRect();k.right>window.innerWidth&&o.classList.add($),k.bottom>window.innerHeight&&o.classList.add(S)}}function u(o){o&&!a&&c.set(o,{node:o,isSubmenu:!0,submenuRefTracker:b,setSubmenuPosition:i})}if(_)return null;let x=A("contexify_item",s,{"contexify_item-disabled":a});return p.createElement(j,{value:b},p.createElement("div",{...T,className:x,ref:u,tabIndex:-1,role:"menuitem","aria-haspopup":!0,"aria-disabled":a,onMouseEnter:i,onTouchStart:i},p.createElement("div",{className:"contexify_itemContent",onClick:o=>o.stopPropagation()},l,p.createElement(re,null,t||p.createElement(ne,null))),p.createElement("div",{className:"contexify contexify_submenu",ref:E,style:h},V(e,{propsFromTrigger:y,triggerEvent:L}))))};export{le as E,oe as F,ce as K,se as i,ae as p};

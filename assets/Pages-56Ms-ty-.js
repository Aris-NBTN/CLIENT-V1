import{c as $,aZ as q,d as T,r as s,j as e,a6 as I,a_ as V,a$ as X,T as h,N as Q,ac as l,b0 as R,W,b1 as Z,b2 as H,b3 as J,b4 as K,b5 as U,b6 as Y}from"./index-BxvyH6Rr.js";import{b7 as ee}from"./Layout-D-b6lE7j.js";import{E as k}from"./Table-REsxD5Ay.js";import{F as m,a as te}from"./jspdf.es.min-CAZgi3nz.js";import{e as ae,f as re}from"./Format-CRg5OEfP.js";import{T as i,m as ie,n as ne,o as C}from"./index-Cjwn6Pe1.js";import{e as se}from"./export-Cugonwx2.js";import{F as o}from"./index-CKlBh-9v.js";import{B as d}from"./TextArea-DAakdzLg.js";import{M as w}from"./index-BBt4H8x4.js";import{I as S}from"./index-CtmaRZ4U.js";import{T as le}from"./index-BseHglsf.js";import"./index-CwcGwJlG.js";import"./index-Bp6v9eQC.js";import"./EllipsisOutlined-Cnz_QTxB.js";import"./Overflow-CRhK7xwX.js";import"./CheckOutlined-LGsS7MTB.js";import"./index-DVtQR3wx.js";import"./index-BoYHRbe4.js";import"./index-DoS5Ws9L.js";import"./SearchOutlined-B1oW2Mb_.js";import"./context-CrMMaZjm.js";import"./sortable.esm-DBGTLdO8.js";import"./addEventListener-6ANR8UZ4.js";import"./iconUtil-zxDw6b5a.js";import"./index-BU3bq95S.js";import"./index-Dp9P72GA.js";import"./index-D63e-2Lo.js";import"./ActionButton-BZ4HPW1v.js";import"./html2canvas.esm-CBrSDip1.js";import"./row-B3kiTypa.js";import"./index-CKMhmnPp.js";const Oe=()=>{const r=$(),N=q({query:"(max-width: 576px)"}),[u]=o.useForm(),[c]=o.useForm(),{pages:n,loading:x}=T(t=>t.pages),{groupPages:g,loading:p}=T(t=>t.groupPages),a=g==null?void 0:g.newData,[D,f]=s.useState(!1),[E,j]=s.useState(!1),[y,b]=s.useState(localStorage.getItem("drag")==="true"),A=s.useMemo(()=>{var t;return(t=n==null?void 0:n.newData)==null?void 0:t.map(F=>({...F,key:F._id}))},[n]),G=s.useMemo(()=>a==null?void 0:a.map(t=>({...t,key:t._id})),[a]),P=[{title:"Tên trang",dataIndex:"name",width:"15%",editable:!0,ellipsis:{showTitle:!0},...m({dataIndex:"name"})},{title:"Link Trang",dataIndex:"slug",width:"15%",editable:!1,ellipsis:{showTitle:!0},...m({dataIndex:"slug"}),render:t=>e.jsx(e.Fragment,{children:e.jsx(i.Paragraph,{className:"!mb-0",ellipsis:{suffix:""},copyable:{text:`/${t}`},children:t})})},{title:"Tiêu đề trang",dataIndex:"title",width:"15%",editable:!0,...m({dataIndex:"title"})},{title:"Mô tả",dataIndex:"description",width:"15%",editable:!0,...m({dataIndex:"description"})},{title:"Từ khóa",dataIndex:"keywords",width:"15%",type:"tag",editable:!0,render:t=>e.jsx(ae,{keywords:t})},{title:"Nhóm",dataIndex:"group",width:"8%",type:"select",editable:!0,optionSelect:Array.isArray(a)&&(a==null?void 0:a.length)>0?a==null?void 0:a.map(t=>({label:t.group,value:t._id})):[],render:t=>t&&a&&Array.isArray(a)&&(a==null?void 0:a.length)>0?re(t,a,"group"):null,...Array.isArray(a)&&(a==null?void 0:a.length)>0?te("group",a==null?void 0:a.map(t=>({text:t.group,value:t._id}))):{}}],M=[{title:"Tên nhóm",dataIndex:"group",width:"60%",type:"text",editable:!0,...m({dataIndex:"group"})}],v=t=>{l(r,Z(t),()=>{f(!1),u.resetFields()})},_=t=>{l(r,H(t))},B=t=>{l(r,J(t))},L=t=>{l(r,K(t),()=>{j(!1),c.resetFields()})},z=t=>{l(r,U(t))},O=t=>{l(r,Y(t))};return s.useEffect(()=>{x&&r(I({page:1,limit:localStorage.getItem("pageSize")||10}))},[]),s.useEffect(()=>{p===!0&&r(V())},[]),e.jsxs(ee,{header:"BÀI VIẾT",button:e.jsxs(e.Fragment,{children:[y?e.jsx(d,{onClick:()=>{b(!1),localStorage.setItem("drag","false")},children:e.jsx(i,{children:"Tắt sắp xếp"})}):e.jsx(d,{type:"primary",onClick:()=>{b(!0),localStorage.setItem("drag","true")},children:e.jsx(i,{children:"Bật sắp xếp "})}),e.jsx(d,{type:"primary",onClick:()=>j(!0),children:e.jsx(i,{children:"Thêm nhóm"})}),e.jsx(d,{type:"primary",onClick:()=>f(!0),children:e.jsx(i,{children:"Thêm trang"})}),e.jsx(d,{onClick:()=>se(A,"Pages.xlsx"),type:"primary",children:e.jsx(i,{children:"Xuất file Excel"})})]}),children:[e.jsx(k,{dragMode:y,Api:I,ApiPut:X,total:n==null?void 0:n.totalItems,loading:x,data:A,columns:P,onSave:_,onDelete:B,width:"12%",button:t=>e.jsxs(e.Fragment,{children:[e.jsx(h,{title:"Xem trang",children:e.jsx(Q,{to:t.slug==="trang-chu"?"/":`/${t.slug}`,target:"_blank",children:e.jsx(ie,{size:22,color:"#006aff"})})}),e.jsx(h,{title:"Sao chép trang",children:e.jsx(i,{onClick:()=>l(r,R(t._id)),children:e.jsx(ne,{size:22,color:"#55ff00"})})}),N?e.jsx(e.Fragment,{children:e.jsx(h,{title:"Chỉnh sửa trang",children:e.jsx(i.Link,{onClick:()=>W("","Bạn không thể truy cập trang này!","Vui lòng sử dụng máy tính để trãi nghiệm tốt nhất!"),children:e.jsx(C,{size:22,color:"rgb(255 127 0)"})})})}):e.jsx(h,{title:"Chỉnh sửa trang",children:e.jsx("a",{href:`/admin/page/${t.slug}`,children:e.jsx(C,{size:22,color:"rgb(255 127 0)"})})})]})}),e.jsx(w,{title:"Thêm trang",centered:!0,open:D,onOk:()=>u.submit(),onCancel:()=>f(!1),confirmLoading:x,width:500,children:e.jsx(o,{form:u,name:"customForm",layout:"vertical",onFinish:v,children:e.jsx(o.Item,{label:"Tên trang",className:"mb-2",name:"name",rules:[{required:!0,message:"Vui lòng nhập tên trang!"}],children:e.jsx(S,{className:"mb-2",placeholder:"Nhập tên trang"})})})}),e.jsx(w,{centered:!0,open:E,confirmLoading:p,onOk:()=>c.submit(),onCancel:()=>j(!1),footer:null,width:600,children:e.jsx(le,{centered:!0,items:[{label:"Thêm nhóm",key:"1",children:e.jsx(e.Fragment,{children:e.jsxs(o,{form:c,name:"customForm",layout:"vertical",onFinish:L,children:[e.jsx(o.Item,{className:"mb-3",name:"group",label:"Tên nhóm",rules:[{required:!0,message:"Nhập tên nhóm!"}],children:e.jsx(S,{placeholder:"Nhập nhóm"})}),e.jsx(d,{type:"primary",loading:p,onClick:()=>c.submit(),className:"flex float-end",children:"Thêm nhóm"})]})})},{label:"Chỉnh sửa nhóm",key:"2",children:e.jsx(e.Fragment,{children:e.jsx(k,{loading:p,data:G,isScroll:!1,columns:M,width:"10%",onSave:z,onDelete:O})})}]})})]})};export{Oe as default};

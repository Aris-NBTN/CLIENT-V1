import{a8 as b,q as C,r as j,s as D,bC as S,j as e,z as v,t as I,G as w}from"./index-D-vX-ogs.js";import{b7 as K}from"./Layout-CTSxCr5d.js";import{F as s}from"./index-DQSqWPWt.js";import{C as i}from"./index-CcEAQu26.js";import{T as h}from"./index-DJbQMTJr.js";import{R as F,C as p}from"./row-DkdzexbX.js";import{B as m}from"./button-CFYAqA28.js";import{M as R}from"./index-C3JqBBAw.js";import{S as a}from"./index-DFZCz_fO.js";import"./index-Bdgj9EGA.js";import"./EllipsisOutlined-lVxL1Af8.js";import"./Overflow-DgiBiHlN.js";import"./context-D6x3uxAl.js";import"./index-Cg1S2uQV.js";import"./index-B-uF5QKH.js";import"./index-BBeicMPk.js";import"./useLocale-DxGBokYH.js";import"./PurePanel-BQc-lBSJ.js";import"./Dropdown-CJVmUJZN.js";import"./index-DL-Lwmo_.js";import"./compact-item-Bdu4HWrL.js";import"./index-C-Lf1fO0.js";import"./TextArea-DXpdnAAN.js";import"./CheckOutlined-C_VsY7tW.js";import"./index-ClmpQXuG.js";import"./SearchOutlined-BtBfneUW.js";const f="/v1/data",T=async()=>await b.get(`${f}`),L=async l=>await b.post(`${f}`,l),B=async l=>await b.post(`${f}/dow-file`,l),E=async l=>await b.post(`${f}`,l),O={backup:T,restore:L,dowBackupFile:B,dowBackupData:E},oe=()=>{const l=C(),[d,n]=j.useState(!1),[u,c]=j.useState(null),[y]=s.useForm(),g=r=>{const o=Object.fromEntries(Object.entries(r).filter(([P,N])=>N!==void 0));Object.keys(o).length>0?(v("restore","Đang Khôi Phục Dữ Liệu..."),O.restore({collections:o}).then(()=>{I("restore","Khôi Phục Dữ Liệu Thành Công!","Dữ liệu đã được khôi phục lại!"),y.resetFields(),n(!1)}).catch(()=>{w("restore","Khôi Phục Dữ Liệu Thất Bại!","Vui lòng thử lại sau!")})):w("restore","Khôi Phục Dữ Liệu Thất Bại!","Vui lòng chọn ít nhất 1 bản ghi cần khôi phục!")},{restore:x,loading:k}=D(r=>r.restore),t=j.useMemo(()=>{var r;return(r=x==null?void 0:x.newData)==null?void 0:r.children.map(o=>({label:o.name,value:o.name}))},[x]);return j.useEffect(()=>{k&&l(S({folderName:"uploads/backup"}))},[]),e.jsxs(K,{title:"Dữ liệu",header:"DỮ LIỆU",children:[e.jsx(i,{className:"h-full",title:e.jsxs(e.Fragment,{children:["Khôi phục dữ liệu ",e.jsx(h.Link,{className:"text-base",children:"data"})]}),children:e.jsxs(F,{gutter:[24,24],children:[e.jsx(p,{xl:{span:8},lg:{span:12},span:"24",children:e.jsx(i,{className:"h-full",children:e.jsxs("div",{className:"flex flex-wrap justify-between items-center",children:[e.jsx(h.Title,{level:5,className:"!my-0",children:"Khôi phục dữ liệu Website"}),e.jsx(m,{type:"primary",onClick:()=>{n(!0),c("website")},children:" Khôi phục"})]})})}),e.jsx(p,{xl:{span:8},lg:{span:12},span:"24",children:e.jsx(i,{className:"h-full",children:e.jsxs("div",{className:"flex flex-wrap justify-between items-center",children:[e.jsx(h.Title,{level:5,className:"!my-0",children:"Khôi phục dữ liệu người dùng"}),e.jsx(m,{type:"primary",onClick:()=>{n(!0),c("users")},children:" Khôi phục"})]})})}),e.jsx(p,{xl:{span:8},lg:{span:12},span:"24",children:e.jsx(i,{className:"h-full",children:e.jsxs("div",{className:"flex flex-wrap justify-between items-center",children:[e.jsx(h.Title,{level:5,className:"!my-0",children:"Khôi phục dữ liệu khóa học"}),e.jsx(m,{type:"primary",onClick:()=>{n(!0),c("courses")},children:" Khôi phục"})]})})}),e.jsx(p,{xl:{span:8},lg:{span:12},span:"24",children:e.jsx(i,{className:"h-full",children:e.jsxs("div",{className:"flex flex-wrap justify-between items-center",children:[e.jsx(h.Title,{level:5,className:"!my-0",children:"Khôi phục dữ liệu đơn hàng"}),e.jsx(m,{type:"primary",onClick:()=>{n(!0),c("orders")},children:" Khôi phục"})]})})}),e.jsx(p,{xl:{span:8},lg:{span:12},span:"24",children:e.jsx(i,{className:"h-full",children:e.jsxs("div",{className:"flex flex-wrap justify-between items-center",children:[e.jsx(h.Title,{level:5,className:"!my-0",children:"Khôi phục khác"}),e.jsx(m,{type:"primary",onClick:()=>{n(!0),c("others")},children:" Khôi phục"})]})})})]})}),e.jsx(R,{title:"Chọn bản ghi cần khôi phục",centered:!0,open:d,onOk:()=>y.submit(),onCancel:()=>n(!1),children:e.jsx(s,{form:y,name:"customRes",layout:"vertical",onFinish:g,children:u=="website"?e.jsxs(e.Fragment,{children:[e.jsx(s.Item,{label:"Thông tin website",className:"mb-2",name:"infos",children:e.jsx(a,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Danh sách bài viết",className:"mb-2",name:"pages",children:e.jsx(a,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Danh sách nhóm bài viết",className:"mb-2",name:"grouppages",children:e.jsx(a,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Bố cục (Header - Footer)",className:"mb-2",name:"layouts",children:e.jsx(a,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})})]}):u=="courses"?e.jsxs(e.Fragment,{children:[e.jsx(s.Item,{label:"Danh sách khóa học",className:"mb-2",name:"courses",children:e.jsx(a,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Danh mục khóa học",className:"mb-2",name:"categorycourses",children:e.jsx(a,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})})]}):u=="users"?e.jsxs(e.Fragment,{children:[e.jsx(s.Item,{label:"Danh sách người dùng",className:"mb-2",name:"users",children:e.jsx(a,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Phân quyền",className:"mb-2",name:"roles",children:e.jsx(a,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})})]}):u=="orders"?e.jsxs(e.Fragment,{children:[e.jsx(s.Item,{label:"Key thanh toán",className:"mb-2",name:"keybanks",children:e.jsx(a,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Danh sách đơn hàng",className:"mb-2",name:"orders",children:e.jsx(a,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})})]}):e.jsxs(e.Fragment,{children:[e.jsx(s.Item,{label:"Danh sách plugins",className:"mb-2",name:"plugins",children:e.jsx(a,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Cài đặt",className:"mb-2",name:"settings",children:e.jsx(a,{disabled:!0,showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})})]})})})]})};export{oe as default};
